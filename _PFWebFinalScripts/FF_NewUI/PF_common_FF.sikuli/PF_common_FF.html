
<html>
   <head>
      <style type="text/css">
         .sikuli-code {
            font-size: 20px;
            font-family: "Osaka-mono", Monospace;
            line-height: 1.5em;
            display:table-cell;
            white-space: pre-wrap;       /* css-3 */
            white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
            white-space: -pre-wrap;      /* Opera 4-6 */
            white-space: -o-pre-wrap;    /* Opera 7 */
            word-wrap: break-word;       /* Internet Explorer 5.5+ */
            width: 99%;   /* remove horizontal scroll-bar when viewing in IE7 */
         }
         .sikuli-code img {
            vertical-align: middle;
            margin: 2px;
            border: 1px solid #ccc;
            padding: 2px;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            -moz-box-shadow: 1px 1px 1px gray;
            -webkit-box-shadow: 1px 1px 2px gray;
         }
         .kw {
            color: blue;
         }
         .skw {
            color: rgb(63, 127, 127);
         }

         .str {
            color: rgb(128, 0, 0);
         }

         .dig {
            color: rgb(128, 64, 0);
         }

         .cmt {
            color: rgb(200, 0, 200);
         }

         h2 {
            display: inline;
            font-weight: normal;
         }

         .info {
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-bottom: 20px;
            display: none;
         }

         a {
            color: #9D2900;
         }

         body {
            font-family: "Trebuchet MS", Arial, Sans-Serif;
         }

      </style>
   </head>
<body>
<div class="info">
<h2>PF_common_FF.sikuli\PF_common.sikuli</h2> <a href="PF_common_FF.sikuli\PF_common.zip">(Download this script)</a>
</div>
<pre class="sikuli-code">
<span class="cmt">#Mar/19/2014 -- David
</span><span class="cmt">#added verify_link(logfile, link) function 
</span><span class="cmt"># added close browser to fail case browser and comment write log to W:\\; added close browser to install extention function
</span><span class="cmt"># changed Google Login to login from link.
</span>
<span class="cmt">#04/14/2014 -- David added close tab function to pass and fail functions
</span><span class="cmt">#04/15/2014 -- Kathy: added load browser for Fail and Pass function, to avoid when browser is not open and the image won't be displayed.
</span><span class="cmt">#04/29/2014 -- David: changed images for get protection value; change image in close tab function
</span><span class="cmt">#05/09/2014 -- Kathy: changed verfy_link function,for some link which are substring of the verify string, will be passed.
</span>                <span class="cmt">#changed load_browser_with_url,if _PF_link is not correct, load it again.
</span>                <span class="cmt">#change take screenshot for log before loading failed link
</span><span class="cmt">#05/22/2014 -- Kathty: 
</span>                <span class="cmt">#1.moved _last_modify right after import section for convenience version checking, added space between functions 
</span>                <span class="cmt">#2.added locate_facebook_section(logfile) in facebookLogin function after detecting facebook already logged in
</span>                <span class="cmt">#3.cleaned up Facebook login function
</span><span class="cmt">#05/23/2014 -- Michael:
</span>                <span class="cmt">#fixed InstallExtension
</span>                <span class="cmt">#changed locate FB section and Facebook LogIn
</span>                <span class="cmt">#changed Twitter login
</span>                <span class="cmt">#changed locate LinkedIn and Linkedin login 
</span>                <span class="cmt">#removed extra dot in images
</span>                <span class="cmt">#changed images names
</span><span class="cmt">#05/28/2014-- Michael:
</span>                <span class="cmt">#Changed locate google section and google log in
</span>                <span class="cmt">#Changed Twitter locate section
</span>                <span class="cmt">#Fixed LinkedIn log in
</span><span class="cmt">#05/28/2014 -- Kathy:
</span>                <span class="cmt"># _reset_url = "https://www.stage.privacyfix.com/start/reset" won't work
</span>                <span class="cmt">#use: _reset_url = "https://stage.privacyfix.com/start/reset" inst
</span>
<span class="cmt">#6/20/2014 -- Kathy: 
</span>                <span class="cmt">#change last modify using time function to get current date
</span>                <span class="cmt">#change write_img_log to use relative path
</span><span class="cmt">#6/25/2014 -- Kathy:                
</span>                <span class="cmt">#changed google login image to "settings"
</span>                <span class="cmt">#added screenshot for Google loging function
</span><span class="cmt">#6/26/2014 -- Kathy:    
</span>                <span class="cmt">#modify facebook login: add locate facebook section
</span>                <span class="cmt">#change facebook locate logic, use "facebook track you on" as end search
</span>                <span class="cmt">#change linkedIn login function, fix reset missing images
</span>
<span class="kw">from</span> __future__ <span class="kw">import</span> with_statement
<span class="kw">import</span> ConfigParser
<span class="kw">import</span> logging
<span class="kw">import</span> shutil
<span class="kw">from</span> sikuli <span class="kw">import</span> *
<span class="kw">import</span> os, re
<span class="kw">from</span> datetime <span class="kw">import</span> datetime
<span class="kw">import</span> time
<span class="kw">from</span> random <span class="kw">import</span> randint

<span class="cmt">#_last_modifed=str(time.strftime("%Y-%m-%d"))
</span>_last_modifed = <span class="str">"2014-06-25 11:13PM by Kathy"</span>
<span class="cmt">#this PF_common is for firefox
</span>_scriptName = <span class="str">"PF_common_FF.sikuli"</span>


<span class="cmt">############## Below is Ron's code, please don't touch #################
</span>
_saveLogToRW = False
_useAutoUser = False


_log_root = <span class="str">"W:\\Logs\\"</span>

<span class="kw">if</span> len(sys.argv) &gt; <span class="dig">1</span> <span class="kw">and</span> sys.argv[<span class="dig">1</span>] == <span class="str">"logrw"</span>:
    _useAutoUser = True
    _saveLogToRW = True

<span class="kw">print</span> <span class="str">"_saveLogToRW: "</span>, _saveLogToRW

<span class="kw">if</span> len(sys.argv) &gt; <span class="dig">1</span> <span class="kw">and</span> sys.argv[<span class="dig">1</span>] == <span class="str">"autoUser"</span>:
    _useAutoUser = True

<span class="kw">print</span> <span class="str">"_useAutoUser: "</span>, _useAutoUser
<span class="cmt">############## Above is Ron's code, please don't touch #################
</span>

<span class="cmt">#_email="eletina1919@gmail.com"
</span>_email=<span class="str">"lyemele@gmail.com"</span>
_password=<span class="str">"qawsed1234"</span>



<span class="cmt">############## Below is Ron's code, please don't touch #################
</span>
<span class="kw">if</span> _useAutoUser:
    <span class="cmt"># when a Driver launches the TC's always use mzhang account.  
</span>    _email = <span class="str">"mzhang0170@gmail.com"</span>
    _password = <span class="str">"zhang0170"</span>

<span class="cmt">############## Above Ron's code, please don't touch #################
</span>
_passed_link = <img src="dl.dropboxusercontent.com/u/40284694/passed.png" />
_failed_link =<img src="dl.dropboxusercontent.com/u/40284694/failed.png" />

<span class="cmt">#_install_link = "stage.privacyfix.com/start/install"
</span>_install_link = <span class="str">"privacyfix.com/start/install"</span>
<span class="cmt">#_PF_link="stage.privacyfix.com/start/"
</span>_PF_link=<span class="str">"privacyfix.com/start"</span>

_reset_url = _PF_link + <span class="str">"/reset"</span>

_firefox_appx86 = <span class="str">"C:\\Program Files (x86)\\Mozilla Firefox\Firefox.exe"</span>
_firefox_app = <span class="str">"C:\\Program Files\\Mozilla Firefox\Firefox.exe"</span>


<span class="kw">if</span> os.path.isfile(_firefox_appx86):
    <span class="cmt">#check for x86 path (x64 bit) 
</span>    _firefox_app =_firefox_appx86

ff_icon =( <img src="fficon.png" />)

_PF_logo=<img src="avgLogo.png" />
_PF_logo1=(<img src="PFTab.png" />)
_PF_Target=(<img src="target.png" />)
_Top_left_reg = Region(<span class="dig">2</span>,<span class="dig">103</span>,<span class="dig">446</span>,<span class="dig">401</span>)
_Top_right_reg =Region(<span class="dig">905</span>,<span class="dig">44</span>,<span class="dig">518</span>,<span class="dig">207</span>)

Page_not_ready=<img src="pageNotReady.png" />
LinkedInloginbutton = <img src="lkLoginButton.png" />
linkedin_section_img = <img src="lkLogedIn.png" />
LinkedIn_top_icon = Pattern(<img src="1403774588454.png" />).similar(<span class="dig">0.90</span>)

<span class="cmt">#linkedIn_profile=(Pattern("1401281272285.png").similar(0.96))
</span><span class="cmt">#LinkedIn_Image=(Pattern("LinkedLogedIn.png").similar(0.90))
</span><span class="cmt">#LinkedIn_LogIn=(Pattern("linkedLogIn.png").similar(0.90))
</span>PF_icon = (Pattern(<img src="iconGrey.png" />).similar(<span class="dig">0.80</span>))
PF_icon_orange=Pattern(<img src="iconOrange.png" />).similar(<span class="dig">0.91</span>)

_rootDir = os.path.dirname(sys.argv[<span class="dig">0</span>].replace(<span class="str">"/"</span>, <span class="str">"\\"</span>))
<span class="cmt"># can't get dynamicially since this will return the calling script (the Tescase Script)
</span><span class="cmt">#_scriptName = os.path.basename(os.path.splitext(sys.argv[0])[0]) + ".sikuli"
</span>
<span class="kw">print</span> <span class="str">"_scriptName: "</span>, _scriptName

<span class="kw">if</span> <span class="str">".sikuli"</span> <span class="kw">in</span> os.path.basename(_rootDir):
    <span class="cmt"># Running in command line returns the path including the sikuli script, different from IDE
</span>    _rootDir = os.path.dirname(_rootDir)
_rootDir = _rootDir + <span class="str">"\\"</span>
<span class="cmt">#_rootDir = "W:\\scripts\\web_app\\chrome\\"
</span><span class="cmt">#_scriptName = 
</span>_thisScript = _rootDir + _scriptName

_commonDashDir = _thisScript + <span class="str">"\\config_dash\\"</span>
_dirMap = {<span class="str">"dir"</span>:_commonDashDir}
_config_file= _commonDashDir + <span class="str">"config.txt"</span>

_config=ConfigParser.ConfigParser(_dirMap)
_config.read(_config_file)

<span class="cmt">#_test_suite_log="W:\\Privacy-fix\\test_suite_log.html"
</span>_test_suite_log=<span class="str">"C:\\test_suite_log.html"</span>


<span class="cmt">#############Firefox specific functions###############################
</span><span class="kw">def</span> load_browser_with_url(link,logfile):
    a=App(<span class="str">"Firefox"</span>)
    reg1=Region(<span class="dig">1000</span>,<span class="dig">0</span>,<span class="dig">440</span>,<span class="dig">200</span>)

    reg1.highlight(<span class="dig">1</span>)
    <span class="kw">if</span> <span class="kw">not</span> reg1.exists(ff_icon):
        App.open(_firefox_app)
        <span class="cmt">#wait_find(ff_icon)
</span>        <span class="skw">sleep</span>(<span class="dig">3</span>)
    switchApp(<span class="str">"Firefox"</span>)
    a.focus()
    <span class="skw">sleep</span>(<span class="dig">3</span>)
    reg1.<span class="skw">find</span>(ff_icon).highlight(<span class="dig">1</span>)
    <span class="kw">if</span> <span class="kw">not</span> reg1.exists(ff_icon):
        <span class="kw">raise</span> Exception(<span class="str">"Firefox is not open!"</span>)

    <span class="kw">if</span> reg1.exists(<img src="1390908075391.png" />):reg1.<span class="skw">click</span>(<img src="1390908075391.png" />)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(<span class="str">"l"</span>, KeyModifier.CTRL)
    <span class="skw">wait</span> (<span class="dig">2</span>)
    <span class="skw">type</span>(link)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    write_log(logfile,<span class="str">"Browser loaded"</span> )
   <span class="cmt"># if link==_PF_link and not exists("1399577787529.png"):#added 5/9/2014
</span>   <span class="cmt">#     #write_log_with_screenshot(logfile,"PF_link page is not loaded, try again!")       
</span>   <span class="cmt">#     type("l", Key.CTRL)
</span>   <span class="cmt">#     wait (2)
</span>   <span class="cmt">#     type(link)
</span>   <span class="cmt">#     sleep(2)
</span>   <span class="cmt">#     type(Key.ENTER)
</span> <span class="cmt">#       sleep(2)        
</span>  <span class="cmt">#  mouseMove(Location(1000,120))
</span><span class="cmt">#
</span><span class="cmt">#############Firefox specific functions###############################
</span><span class="kw">def</span> get_img_value(logfile,image):
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(Key.F12)
    <span class="skw">sleep</span>(<span class="dig">3</span>)
    <span class="kw">if</span> exists(<img src="1399365445269.png" />):
        wait_click(<img src="1399365462169.png" />)
    wait_click(<img src="1399365479164.png" />)
    wait_click(<img src="1388481681375-1.png" />)
    <span class="skw">sleep</span>(<span class="dig">3</span>)

    <span class="kw">if</span> exists(image):
        write_log_with_screenshot(logfile, <span class="str">"protection level image found!"</span>)
        <span class="skw">click</span>(image)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        <span class="skw">type</span>(Key.RIGHT)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        write_log_with_screenshot(logfile, <span class="str">"Screen after click on right key"</span>)
        <span class="skw">type</span>(Key.DOWN)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(Key.ENTER)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(<span class="str">"c"</span>, KEY_CTRL)
        <span class="kw">print</span> <span class="str">"CTRL_C pressed!"</span>
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        <span class="cmt">#App.open("%windir%\system32\notepad.exe")
</span>        <span class="skw">type</span>(<span class="str">"v"</span>, Key.CTRL)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        data=Env.getClipboard()
        <span class="kw">print</span> <span class="str">"txt: "</span> + str(data)
        value1=int(data.replace(<span class="str">'%'</span>,<span class="str">''</span>))
        <span class="skw">type</span>(Key.F12)
        <span class="kw">print</span> value1
        <span class="kw">return</span> value1
    <span class="kw">else</span>:
        msg=<span class="str">"Not able to get protection value!"</span>
        write_log_with_screenshot(logfile, msg)
        <span class="kw">raise</span> Exception(msg)

<span class="cmt">#############Firefox specific functions###############################
</span><span class="kw">def</span> get_protection_value(logfile):

    search_txt1=(<img src="1399365553117.png" />)


    switchApp(<span class="str">"Firefox"</span>)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="cmt">#search_str2="num_private_settings\n"s
</span>    <span class="cmt">#search_str1="fb_protection_percent\n"
</span>    <span class="kw">print</span> <span class="str">"search img: "</span> +str(search_txt1)
    percent_value = get_img_value(logfile,search_txt1)
    <span class="cmt">#list2 = get_img_value(search_txt2,search_str2)
</span>    <span class="cmt">#print percent_value
</span>    write_log(logfile,<span class="str">"Protection value is:"</span> + str(percent_value))
    screen_shot=<span class="skw">capture</span>(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1350</span>,<span class="dig">850</span>)
    write_screenshot_log(logfile,screen_shot)
    <span class="kw">return</span> percent_value

<span class="cmt">#############Firefox specific functions###############################
</span><span class="kw">def</span> ClearBrowsingData(logfile):
    a=App(<span class="str">"Firefox"</span>)
    <span class="kw">if</span> <span class="kw">not</span> exists(ff_icon):
        App.open(_firefox_app)
        wait_find(ff_icon)
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">120</span>))
    switchApp(<span class="str">"Firefox"</span>)
    a.focus()
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(<span class="str">"s"</span>, Key.ALT)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">click</span>(<img src="1391300359244.png" />)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(<span class="str">"e"</span>)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(Key.ENTER)
    write_log(logfile,<span class="str">"\n&lt;p&gt;Browsing Data was cleared/p&gt;\n"</span>)

<span class="cmt">#############Firefox specific functions###############################
</span><span class="kw">def</span> RemoveExt(logfile):
    load_browser_with_url(<span class="str">"about:blank"</span>,logfile)
    PF_icon = (Pattern(<img src="1389954724256.png" />).similar(<span class="dig">0.80</span>))

    write_log_with_screenshot(logfile, <span class="str">"FF is opened!"</span>)

    <span class="kw">if</span> <span class="kw">not</span> exists(PF_icon):
        write_log_with_screenshot(logfile, <span class="str">"PF is not installed or removed!"</span>)
        <span class="kw">return</span>
    Extensions = (<img src="extensions.png" />)
    Delete = (<img src="deleteData.png" />)
    Remove = (<img src="removeHistory.png" />)
    <span class="skw">sleep</span>(<span class="dig">3</span>)
    <span class="kw">if</span> exists(PF_icon):
        <span class="skw">type</span>(<span class="str">"a"</span>, KeyModifier.CTRL + KeyModifier.SHIFT )
        <span class="skw">sleep</span>(<span class="dig">5</span>)
        <span class="skw">click</span>(Pattern(Extensions).similar(<span class="dig">0.90</span>))


        <span class="skw">sleep</span>(<span class="dig">2</span>)
        <span class="skw">doubleClick</span>(Delete)
        <span class="skw">click</span>(Remove)

        write_log(logfile,<span class="str">"\n&lt;p&gt;Extension was remowed&lt;/p&gt;\n"</span>)
        <span class="skw">type</span>(<span class="str">"w"</span>, Key.CTRL)  <span class="cmt">#--- close tab because ctrl_l on this page is different.</span>
    <span class="kw">else</span>:
        write_log(logfile, <span class="str">"PF already removed!"</span>)
        <span class="kw">return</span>
    write_log(logfile, <span class="str">"&lt;p&gt;extension removed successfully&lt;/p&gt;\n"</span>)

<span class="cmt">#############Firefox specific functions###############################
</span><span class="kw">def</span> InstallExtension(logfile):
    Get_AVG_PF = (<img src="1389956575753.png" />)
    Allow = (<img src="1389956735269.png" />)
    install= (<img src="1389956873839.png" />)
    Arrow= (<img src="1389957193540.png" />)
    Skip= (<img src="1389957226628.png" />)
    PF_icon = (Pattern(<img src="1400840767646.png" />).similar(<span class="dig">0.90</span>))
    PF_icon_green =(Pattern(<img src="1400242292843.png" />).similar(<span class="dig">0.78</span>))
    reg2=Region(<span class="dig">0</span>,<span class="dig">5</span>,<span class="dig">467</span>,<span class="dig">303</span>)
    pfTab=(<img src="1400745489468.png" />)

    <span class="kw">if</span> reg2.exists(pfTab):
        <span class="skw">click</span> (pfTab)
        <span class="kw">print</span> <span class="str">"PF is already installed!"</span>
        write_log_with_screenshot(logfile, <span class="str">"PF is already installed!"</span>)
        <span class="kw">return</span>

    <span class="kw">if</span> <span class="kw">not</span> exists(ff_icon <span class="kw">or</span> PF_icon_green): App.open(_firefox_app)
    verify(logfile,ff_icon)
    <span class="skw">sleep</span>(<span class="dig">4</span>)
    load_browser_with_url(<span class="str">"about:blank"</span>,logfile)
    <span class="skw">sleep</span>(<span class="dig">3</span>)
    <span class="kw">if</span> exists(Pattern(PF_icon).similar(<span class="dig">0.90</span>) <span class="kw">or</span> PF_icon_green):
        <span class="skw">find</span>(PF_icon).highlight(<span class="dig">1</span>)
        <span class="kw">print</span> <span class="str">"PF is already installed!"</span>
        write_log_with_screenshot(logfile, <span class="str">"PF is already installed!"</span>)
        <span class="kw">return</span>
    load_browser_with_url(_install_link,logfile)
    verify(logfile,Get_AVG_PF)
    <span class="skw">click</span>(Get_AVG_PF)
    <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="skw">click</span>(Allow)

    verify(logfile,install)
    <span class="skw">click</span>(install)
    <span class="skw">wait</span>(<span class="dig">5</span>)
    i=<span class="dig">0</span>
    <span class="kw">while</span> (i &lt; <span class="dig">3</span>):
        <span class="kw">if</span> exists(Arrow):<span class="skw">click</span>(Arrow)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        i+=<span class="dig">1</span>
        <span class="kw">print</span> <span class="str">"i is:"</span> + str(i)
    <span class="cmt">#if exists(Arrow):find().highlight(1);click(Skip) 
</span>    ClearBrowsingData(logfile)              <span class="cmt">#avoid install link autofill for _PF_link</span>
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(<span class="str">"w"</span>, KeyModifier.CTRL + KeyModifier.SHIFT )
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    load_browser_with_url(_PF_link,logfile)
    write_log(logfile, <span class="str">"&lt;p&gt;extension installed successfully&lt;/p&gt;\n"</span>)

<span class="cmt">################Common functions for all browsers##################################
</span><span class="kw">def</span> locate_linkedIn_section(logfile):
    LinkedInloginbutton = <img src="lkLoginButton.png" />
    linkedin_section_img=<img src="lkLogedIn.png" />
    <span class="kw">if</span> _Top_right_reg.exists(LinkedIn_top_icon):
        locate_item_page_by_page(logfile, linkedin_section_img)
        locate_item_line_by_line(logfile,<img src="1403774743991.png" />)
        write_log_with_screenshot(logfile, <span class="str">"Facebook logged in, and facebook section located!"</span>)
    <span class="kw">else</span>:
        locate_item_page_by_page(logfile, LinkedInloginbutton)
        write_log_with_screenshot(logfile, <span class="str">"Facebook is not logged in, and facebook section located!"</span>)

<span class="kw">def</span> locate_linkedIn_section01(logfile):
    linkedInBoard=(Pattern(<img src="linkedBoard.png" />).similar(<span class="dig">0.90</span>))

    mouseMove(Location(<span class="dig">1000</span>,<span class="dig">120</span>))
    i=<span class="dig">0</span>
    <span class="kw">while</span> <span class="kw">not</span> exists(linkedInBoard) <span class="kw">and</span> <span class="kw">not</span> exists(LinkedIn_LogIn)<span class="kw">and</span> i&lt;<span class="dig">8</span> :
        <span class="skw">type</span>(Key.DOWN)
        <span class="skw">type</span>(Key.DOWN)
        <span class="skw">type</span>(Key.DOWN)
        <span class="skw">type</span>(Key.DOWN)
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">110</span>))
        i+=<span class="dig">1</span>

    write_log(logfile, <span class="str">"locating linkedIn section"</span>)
    <span class="kw">if</span> (<span class="kw">not</span> exists (LinkedIn_LogIn)):

        <span class="kw">return</span> <span class="dig">0</span>

    <span class="kw">else</span>:
        <span class="kw">return</span> <span class="dig">1</span>


    mouseMove(Location(<span class="dig">1000</span>,<span class="dig">120</span>))

<span class="cmt">#find google section image, and use down key to find Tracking section image
</span><span class="cmt">#This is to make sure the whole google section is completely showing on screen
</span><span class="cmt">#find google section image, and use down key to find Tracking section image
</span><span class="cmt">#This is to make sure the whole google section is completely showing on screen
</span><span class="kw">def</span> locate_google_section(logfile):
 <span class="cmt">#   load_browser_with_url(_PF_link)
</span>    GoogleLogo=(<img src="1401268453465.png" />)
    googlBoard=(Pattern(<img src="1401268735790.png" />).similar(<span class="dig">0.91</span>))
    notLoggedIn=(<img src="1401268681923.png" />)
    i=<span class="dig">0</span>
    mouseMove(Location(<span class="dig">1000</span>,<span class="dig">120</span>))
    <span class="skw">sleep</span>(<span class="dig">2</span>)

    <span class="cmt">#load_browser_with_url(_PF_link,logfile)
</span>    <span class="skw">type</span>(Key.HOME)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.DOWN)
    <span class="skw">type</span>(Key.DOWN)
    <span class="skw">type</span>(Key.DOWN)
    <span class="skw">type</span>(Key.DOWN)

    <span class="cmt">#while (not exists(googlBoard)  and i&lt;6):
</span>    <span class="cmt">#    type(Key.DOWN)
</span>    <span class="cmt">#    mouseMove(Location(1000,110))        
</span>    <span class="cmt">#    i+=1
</span>    <span class="cmt">#    sleep(3)
</span>    write_log(logfile, <span class="str">"locating google section"</span>)
    <span class="kw">if</span> (<span class="kw">not</span> exists (notLoggedIn)):
        <span class="cmt">#type(Key.HOME)
</span>        <span class="kw">return</span> <span class="dig">1</span>

    <span class="kw">else</span>:

        <span class="kw">return</span> <span class="dig">0</span>



<span class="kw">def</span> locate_tracking_section(logfile):    <span class="cmt">#locate both tracking and websites section together</span>


    tracking_section_img=<img src="personalData.png" />

    <span class="kw">if</span> <span class="kw">not</span> exists(tracking_section_img):
        <span class="skw">type</span>(Key.HOME)
        <span class="kw">if</span> <span class="kw">not</span> exists(_PF_logo):
            load_browser_with_url(_PF_link,logfile)
            wait_find(_PF_logo)
            waitVanish(Page_not_ready)
            <span class="skw">sleep</span>(<span class="dig">2</span>)

    mouseMove(Location(<span class="dig">1000</span>,<span class="dig">200</span>))

<span class="kw">def</span> locate_facebook_section(logfile):
    fb_logged_in=(<img src="FBLimage-1.png" />)
    <span class="cmt">#fb_board=("shareprivacyfix.png")
</span>    fb_tracks_you_on = (<img src="1403767947919.png" />)

    fb_logInbutton=(Pattern(<img src="fbLoginButton.png" />).similar(<span class="dig">0.90</span>))
    <span class="kw">if</span> _Top_right_reg.exists(<img src="1403768600238.png" />):
        locate_item_page_by_page(logfile, fb_logged_in)
        locate_item_line_by_line(logfile,fb_tracks_you_on)
        write_log_with_screenshot(logfile, <span class="str">"Facebook logged in, and facebook section located!"</span>)
    <span class="kw">else</span>:
        locate_item_page_by_page(logfile, fb_logInbutton)
        write_log_with_screenshot(logfile, <span class="str">"Facebook is not logged in, and facebook section located!"</span>)

<span class="kw">def</span> locate_twitter_section(logfile):
    twitterLogin=(Pattern(<img src="twitterLogIn.png" />).similar(<span class="dig">0.90</span>))
    twitterLogo=(Pattern(<img src="twitterLogedIn.png" />).similar(<span class="dig">0.91</span>))
    i=<span class="dig">0</span>
    <span class="kw">while</span> (<span class="kw">not</span> exists(twitterLogin) <span class="kw">and</span>  <span class="kw">not</span> exists( twitterLogo) <span class="kw">and</span> i&lt;<span class="dig">2</span>):
        <span class="skw">type</span>(Key.PAGE_DOWN)
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">110</span>))
        i+=<span class="dig">1</span>
        <span class="skw">sleep</span>(<span class="dig">3</span>)
    write_log(logfile, <span class="str">"locating twitter section"</span>)
    <span class="kw">if</span> (<span class="kw">not</span> exists (twitterLogin)):
        <span class="skw">type</span>(Key.HOME)
        <span class="kw">return</span> <span class="dig">0</span>

    <span class="kw">else</span>:

        <span class="kw">return</span> <span class="dig">1</span>


<span class="cmt">#Login to google account
</span><span class="kw">def</span> GoogleLogin(logfile):
    start_time=datetime.now()
    write_log(logfile, <span class="str">"detecting browser..."</span>)
    <span class="kw">if</span> <span class="kw">not</span> exists(_PF_logo):
        load_browser_with_url(_PF_link,logfile)
        <span class="skw">sleep</span>(<span class="dig">2</span>)

        wait_find(_PF_logo)
        write_log_with_screenshot(logfile, _PF_link + <span class="str">"link entered!"</span>)
        waitVanish(Page_not_ready)
        <span class="skw">sleep</span>(<span class="dig">5</span>)

    write_log(logfile, <span class="str">"total time detecting browser is: "</span> + str(datetime.now()-start_time))


    locate_google_section(logfile)
    google_login=(<img src="1401272615407.png" />)

    <span class="kw">if</span> exists(google_login):
        <span class="cmt">#load_browser_with_url("https://accounts.google.com")
</span>        <span class="cmt">#click(google_login)
</span>        google_account_link=<span class="str">"https://accounts.google.com/Login?continue=https://history.google.com/history/settings%3Fhl%3Den&amp;hl=en"</span>
        load_browser_with_url(google_account_link,logfile)
        wait_find(<img src="singIn.png" />)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        <span class="kw">if</span> exists(<img src="emailgl.png" />):
            <span class="skw">type</span>(_email)
            <span class="skw">sleep</span>(<span class="dig">1</span>)
            <span class="skw">type</span>(Key.TAB)
        <span class="skw">type</span>(_password)
        write_log_with_screenshot(logfile, <span class="str">"after enter password"</span>)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(Key.ENTER)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        verify(logfile,<img src="1403436914889.png" />)
        write_log(logfile, <span class="str">"logged into Google successfully\n"</span>)
        write_log(logfile, <span class="str">"Total time for Google login is: "</span> + str(datetime.now()-start_time))
        load_browser_with_url(_PF_link,logfile)
        wait_find(_PF_logo)
        <span class="skw">sleep</span>(<span class="dig">5</span>)
        locate_google_section(logfile)
        write_log_with_screenshot(logfile,<span class="str">"logged into Google successfully\n"</span>)
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">120</span>))

    <span class="kw">else</span>:
        write_log_with_screenshot(logfile, <span class="str">"Already logged into Google!\n"</span>)
        <span class="kw">print</span> <span class="str">"Already logged into Google!\n"</span>
        write_log(logfile, <span class="str">"Total time for Google login is: "</span> + str(datetime.now()-start_time))
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">110</span>))

<span class="cmt">#Logging to Facebook
</span><span class="kw">def</span> FacebookLogin(logfile):

    start_time=datetime.now()

    Fb_logedIn=(Pattern(<img src="fbicon.png" />).similar(<span class="dig">0.90</span>))
    _Top_right_reg.highlight(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.HOME)
    <span class="kw">if</span> <span class="kw">not</span> _Top_right_reg.exists(_PF_logo):
        write_log(logfile, <span class="str">"total time detecting PF logo not exist time is: "</span> + str(datetime.now()-start_time))
        load_browser_with_url(_PF_link,logfile)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        write_log(logfile, <span class="str">"total time loading browser is: "</span> + str(datetime.now()-start_time))
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="kw">if</span> (wait_find(_PF_logo1)==<span class="dig">0</span>): wait_find(_PF_logo1)
        <span class="kw">if</span> <span class="kw">not</span> _Top_right_reg.exists(_PF_Target):wait_find(_PF_Target)
        write_log_with_screenshot(logfile, _PF_link + <span class="str">" link entered!"</span>)
        _Top_left_reg.waitVanish(Page_not_ready)
        <span class="skw">sleep</span>(<span class="dig">2</span>)

    write_log(logfile, <span class="str">"total time detecting browser is: "</span> + str(datetime.now()-start_time))

    write_log_with_screenshot(logfile,<span class="str">"Loaded PF page"</span>)
    logged = _config.get(<span class="str">'Facebook_Login'</span>, <span class="str">"logged"</span>)
    loginbutton = _config.get(<span class="str">'Facebook_Login'</span>, <span class="str">"loginbutton"</span>)
    fb_logged_in_icon=_config.get(<span class="str">'Facebook_Login'</span>, <span class="str">"fb_logged_in_icon"</span>)
    <span class="cmt">#locate_facefook_section(logfile)
</span>    <span class="cmt">#if in Facebook section, and login button is not there, then it's logged in.
</span>    <span class="cmt">#y=verify_continue(logfile,fb_logged_in_icon)
</span>    <span class="cmt">#print "in PF_common_FF, y is:" +str(y)
</span>    <span class="skw">type</span>(Key.HOME)
    <span class="kw">if</span> _Top_right_reg.exists (Fb_logedIn):
        <span class="skw">find</span>(Fb_logedIn).highlight(<span class="dig">1</span>)

        write_log_with_screenshot(logfile, <span class="str">"Facebook is already logged in!"</span>)
        write_log(logfile, <span class="str">"total time detect logged in is: "</span> + str(datetime.now()-start_time))
        locate_facebook_section(logfile)
        <span class="kw">return</span>
    <span class="cmt">#locate_facefook_section(logfile)
</span>    <span class="cmt">#write_log(logfile, "total time detect logged in FB icon is: " + str(datetime.now()-start_time))                                
</span>    <span class="cmt">#if login button shown in facebook section, then login to facebook section
</span>    <span class="cmt">#fb_logo = _config.get('Facebook_Login', "FB_logo")
</span> <span class="cmt">#   cert_warning = _config.get('Facebook_Login', "cert_warning")
</span>    <span class="cmt">#proceed = _config.get('Facebook_Login', "proceed")
</span>

    locate_item_page_by_page(logfile,loginbutton)
    <span class="skw">click</span>(Pattern(loginbutton).similar(<span class="dig">0.90</span>).targetOffset(<span class="dig">224</span>,<span class="dig">0</span>))

    <span class="skw">sleep</span>(<span class="dig">2</span>)
    reg_FBtab=Region(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1440</span>,<span class="dig">200</span>)
    wait_find_reg(reg_FBtab,<img src="facebook_tab_logo.png" />)
    ok_reg=Region(<span class="dig">548</span>,<span class="dig">449</span>,<span class="dig">469</span>,<span class="dig">350</span>)
    okey_button=(<img src="ok1.png" />)
    ok_button=(<img src="ok2.png" />)

    <span class="kw">if</span> exists(okey_button):
        <span class="skw">click</span>(okey_button)
        <span class="skw">sleep</span>(<span class="dig">3</span>)
        <span class="kw">if</span> exists(okey_button):
            <span class="skw">click</span>(okey_button)
            <span class="skw">sleep</span>(<span class="dig">3</span>)
        verify(logfile,fb_logged_in_icon)
    write_log(logfile, <span class="str">"total time detect ok button is: "</span> + str(datetime.now()-start_time))

    verify(logfile,<img src="fbPageLogo.png" />)
    login_reg=Region(<span class="dig">377</span>,<span class="dig">170</span>,<span class="dig">454</span>,<span class="dig">399</span>)
    login_reg.highlight(<span class="dig">1</span>)
    <span class="cmt">#print "loggin region is: " +login_reg.X()+" "+login_reg.Y() 
</span>    username1=Pattern(<img src="1390307763657.png" />).similar(<span class="dig">0.87</span>)
    username2=Pattern(<img src="1389809891723.png" />).similar(<span class="dig">0.90</span>)
    username3=(Pattern(<img src="1390183106564.png" />).similar(<span class="dig">0.90</span>))

    <span class="kw">if</span> login_reg.exists(username1) <span class="kw">or</span> login_reg.exists(username2) <span class="kw">or</span> login_reg.exists(username3):
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(_email)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        write_log_with_screenshot(logfile,<span class="str">"email entered"</span>)
        <span class="skw">type</span>(Key.TAB)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
    write_log(logfile, <span class="str">"total time detect FB login username is: "</span> + str(datetime.now()-start_time))
    <span class="skw">type</span>(_password)
    write_log_with_screenshot(logfile,<span class="str">"password entered"</span>)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">sleep</span>(<span class="dig">5</span>)
    write_log_with_screenshot(logfile,<span class="str">"after login to facebook"</span>)

    <span class="kw">if</span> ok_reg.exists(okey_button):
        <span class="skw">click</span>(okey_button)
        <span class="skw">sleep</span>(<span class="dig">3</span>)
        <span class="kw">if</span> exists(okey_button):
            <span class="skw">click</span>(okey_button)
        <span class="skw">sleep</span>(<span class="dig">3</span>)
        verify(logfile,logged)

    write_log_with_screenshot(logfile, <span class="str">"Logged into Facebook successfully!"</span>)

    locate_facebook_section(logfile)
    write_log(logfile, <span class="str">"Total Facebook login time is: "</span> + str(datetime.now()-start_time))

<span class="kw">def</span> LinkedInLogIn(logfile):

    start_time=datetime.now()

    <span class="cmt">#LinkedInloginbutton = "lkLoginButton.png"
</span>    <span class="cmt">#linkedin_section_img="lkLogedIn.png"
</span>    <span class="cmt">#linkedIn_profile=(Pattern("1401281272285.png").similar(0.96))
</span>    <span class="cmt">#LinkedLogeedIn=("1401281749494.png")
</span>
    <span class="kw">if</span>  <span class="kw">not</span> _Top_left_reg.exists(_PF_logo):

        load_browser_with_url(_PF_link,logfile)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        wait_find(_PF_logo)
        write_log_with_screenshot(logfile, _PF_link + <span class="str">"link entered!"</span>)
        waitVanish(Page_not_ready)
        <span class="skw">sleep</span>(<span class="dig">2</span>)

        write_log(logfile, <span class="str">"total time detecting browser is: "</span> + str(datetime.now()-start_time))
        <span class="skw">wait</span>(<span class="dig">5</span>)

    <span class="kw">if</span>  _Top_right_reg.exists(LinkedIn_top_icon):
        <span class="skw">find</span>(LinkedIn_top_icon).highlight(<span class="dig">1</span>)
        write_log_with_screenshot(logfile, <span class="str">"Find LinkedIn_top_icon, already logged in LinkedIn!"</span>)
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">120</span>))
        locate_linkedIn_section(logfile)
        <span class="kw">return</span>
    <span class="cmt">#look for LinkedIn section image to locate LinkedIn section
</span>    locate_linkedIn_section(logfile)
    verify(logfile, LinkedInloginbutton)
    <span class="skw">click</span> (Pattern(LinkedInloginbutton).similar(<span class="dig">0.70</span>).targetOffset(<span class="dig">223</span>,<span class="dig">0</span>))
    <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="kw">if</span> exists (Pattern(<img src="rassentered.png" />).similar(<span class="dig">0.91</span>)):
        <span class="skw">type</span>(Key.TAB)
        <span class="skw">type</span>(Key.TAB)
        <span class="skw">type</span>(Key.TAB)
        <span class="skw">type</span>(Key.ENTER)
        write_log(logfile, <span class="str">"password was saved in cookies"</span>)
        <span class="skw">wait</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(<span class="str">"w"</span>, Key.CTRL)
        <span class="kw">return</span>
    verify(logfile, <img src="passwordlk.png" />)

    <span class="kw">if</span> exists(<img src="1391454308746.png" />):

        <span class="skw">type</span>(Key.TAB)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        <span class="skw">type</span>(_email)
        write_log_with_screenshot(logfile,<span class="str">"email entered"</span>)

    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(_password)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    write_log_with_screenshot(logfile,<span class="str">"password entered"</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(<span class="str">"w"</span>, Key.CTRL)
    <span class="skw">sleep</span>(<span class="dig">3</span>)

    <span class="cmt">#verify(logfile,LinkedLogeedIn)
</span>    verify(logfile,linkedin_section_img)
    write_log(logfile, <span class="str">"logged into LinkedIn successfully"</span>)
    write_log(logfile, <span class="str">"Total LinkedIn login time is: "</span> + str(datetime.now()-start_time))
    <span class="cmt">#close the logged in tab, suppose to close by itself. it's a bug right now, if fixed in the future, please delete this line
</span>    <span class="skw">sleep</span>(<span class="dig">5</span>)
    locate_linkedIn_section(logfile)

    write_log_with_screenshot(logfile, <span class="str">"screenshot after logged into linkedin!"</span>)
    write_log(logfile, <span class="str">"Total LinkedIn login time is: "</span> + str(datetime.now()-start_time))


<span class="kw">def</span> TwitterLogIn(logfile):
    twitterLogin=(Pattern(<img src="twitterLogIn.png" />).similar(<span class="dig">0.90</span>))
    twitterLogo=(Pattern(<img src="twitterLogedIn.png" />).similar(<span class="dig">0.91</span>))

    <span class="kw">if</span> <span class="kw">not</span> exists(_PF_logo <span class="kw">or</span> twitterLogo):
        load_browser_with_url(_PF_link,logfile)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        wait_find(_PF_logo)
        write_log_with_screenshot(logfile, _PF_link + <span class="str">"link entered!"</span>)
        waitVanish(Page_not_ready)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="kw">if</span> locate_twitter_section(logfile)==<span class="dig">1</span>:
        <span class="skw">click</span>(twitterLogin.targetOffset(<span class="dig">120</span>,<span class="dig">0</span>))
        <span class="skw">wait</span>(<span class="dig">3</span>)
        <span class="kw">if</span> exists (<img src="1400834986301.png" />):
            <span class="skw">click</span>(<img src="1400835009686.png" />)
            <span class="skw">wait</span>(<span class="dig">2</span>)
            <span class="skw">type</span>(<span class="str">"w"</span>, Key.CTRL)
            <span class="skw">type</span>(<span class="str">"r"</span>, Key.CTRL)
            <span class="skw">wait</span>(<span class="dig">5</span>)
            <span class="kw">return</span>

        <span class="skw">type</span>(<span class="str">"michael.scott.avg@gmail.com"</span>)
        <span class="skw">type</span>(Key.TAB)
        <span class="skw">wait</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(<span class="str">"US!pf.avg"</span>)
        <span class="skw">type</span>(Key.TAB)
        <span class="skw">type</span>(Key.ENTER)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        <span class="skw">type</span>(<span class="str">"w"</span>, Key.CTRL)
        <span class="skw">type</span>(<span class="str">"r"</span>, Key.CTRL)
        <span class="skw">wait</span>(<span class="dig">5</span>)
        write_log(logfile, <span class="str">"You logged into Twitter "</span>)
    <span class="kw">else</span>:

        write_log(logfile, <span class="str">"You already logged into Twitter"</span>)


<span class="kw">def</span> write_log(logfile,msg):
    <span class="kw">with</span> open(logfile, <span class="str">'a+'</span>) <span class="kw">as</span> fo:
        fo.write(<span class="str">"\n&lt;p&gt; "</span> + str(datetime.now())+ <span class="str">":   "</span> + msg+  <span class="str">" &lt;/p&gt;\n"</span>)


<span class="kw">def</span> write_log_with_screenshot(logfile,msg):
    write_log(logfile,msg)
    scr_shot=<span class="skw">capture</span>(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1400</span>,<span class="dig">900</span>)
    write_screenshot_log(logfile,scr_shot)

<span class="kw">def</span> write_img_log(logfile,img):
    <span class="kw">print</span> <span class="str">"img in write_img_log is: "</span> + img
    path_common=_rootDir + _scriptName + <span class="str">"\\"</span>
    <span class="kw">print</span> <span class="str">"path_common is: "</span> + path_common

    dst_path, script_name =os.path.split(logfile)
    <span class="kw">print</span> <span class="str">"dst_path is: "</span> + dst_path

    script_path, script_name=os.path.split(dst_path)
    path_script=_rootDir + script_name + <span class="str">".sikuli\\"</span>
    <span class="kw">print</span> <span class="str">"path_script is: "</span> + path_script
    src_file=<span class="str">""</span>
    <span class="kw">if</span> <span class="kw">not</span> <span class="str">"\\"</span> <span class="kw">in</span> img: <span class="cmt">#for the img doesn't have path, only have file name, add path to get full path for source file</span>
        <span class="kw">if</span> os.path.exists(path_common + img): src_file = path_common + img;<span class="kw">print</span> <span class="str">"img is from common folder, full path:"</span> + src_file
        <span class="kw">if</span> os.path.exists(path_script + img): src_file = path_script + img;<span class="kw">print</span> <span class="str">"img is from script folder, full path:"</span> + src_file
        dst_file = dst_path + <span class="str">"\\"</span> + img  <span class="cmt">#destination file with path</span>

    <span class="kw">else</span>: <span class="cmt">#for the img with full path, change the path to destination path for copy</span>
        src_file = img
        <span class="kw">print</span> <span class="str">"img is from full path folder, full path:"</span> + src_file
        img_path,img_name=os.path.split(img)
        dst_file = dst_path + <span class="str">"\\"</span> + img_name <span class="cmt">#destination file with path</span>
        <span class="kw">print</span> <span class="str">"should be full path, dst_file is:"</span> + dst_file
        img = img_name
    <span class="cmt">#copy the file to log folder 
</span>    <span class="kw">print</span> <span class="str">"src_file is:"</span> + src_file
    <span class="kw">print</span> <span class="str">"dst_file is:"</span> + dst_file
    shutil.copyfile(src_file, dst_file)

    <span class="cmt">#write to logfile
</span>    <span class="kw">with</span> open(logfile, <span class="str">'a+'</span>) <span class="kw">as</span> fo:
        msg=<span class="str">'\n&lt;img border=\"0" src="'</span> + img + <span class="str">'"&gt;&lt;/img_new&gt;\n'</span>
        fo.write(msg)

<span class="kw">def</span> write_img_log0(logfile,img):

    <span class="kw">with</span> open(logfile, <span class="str">'a+'</span>) <span class="kw">as</span> fo:
        <span class="kw">try</span>:
            <span class="kw">print</span>(img)
            <span class="kw">if</span> <span class="str">'\\PF-'</span> <span class="kw">in</span> logfile:
                script_name_old=str(logfile).split(<span class="str">"\\PF-"</span>)[<span class="dig">0</span>]
            <span class="kw">if</span> <span class="str">'\\Logs'</span> <span class="kw">in</span> script_name_old:
                script_name=str(script_name_old).replace(<span class="str">"\\Logs"</span>, <span class="str">""</span>)
            <span class="kw">if</span> <span class="str">'\\PF_WebApp'</span> <span class="kw">in</span> script_name:
                common=str(script_name).split(<span class="str">"\\PF_WebApp"</span>)[<span class="dig">0</span>]
                common=common +<span class="str">"\\PF_common_FF.sikuli\\"</span>+ img
            <span class="kw">if</span> os.path.exists(common):
                scr=common
                <span class="kw">print</span>(scr)
                dst=script_name_old+<span class="str">"\\"</span>+ img
                <span class="kw">print</span>(dst)
                shutil.copyfile(scr, dst)
                <span class="cmt">#open(dst,"w").write(open(scr,"r").read())
</span>                msg=<span class="str">'\n&lt;img border=\"0" src="'</span> + img+ <span class="str">'"&gt;&lt;/img&gt;\n'</span>
                fo.write(msg)
                <span class="kw">return</span>
            <span class="kw">if</span> <span class="str">"common"</span> <span class="kw">in</span> img:
                scr=img
                img_new=str(randint(<span class="dig">10000</span>,<span class="dig">99999</span>))+<span class="str">'.png'</span>
                <span class="kw">print</span>(<span class="str">"in common"</span> +scr)
                dst=script_name_old+<span class="str">"\\"</span>+ img_new
                <span class="kw">print</span>(<span class="str">"in common"</span>+dst)
                shutil.copyfile(scr, dst)
                <span class="cmt">#open(dst,"w").write(open(scr,"r").read())
</span>                msg=<span class="str">'\n&lt;img border=\"0" src="'</span> + img+ <span class="str">'"&gt;&lt;/img_new&gt;\n'</span>
                fo.write(msg)
                <span class="kw">return</span>
            scr=script_name +<span class="str">".sikuli\\"</span>+ img
            <span class="kw">print</span>(<span class="str">"not common"</span> +scr)
            dst=script_name_old+<span class="str">"\\"</span>+ img
            <span class="kw">print</span>(<span class="str">"not common"</span>+dst)
            shutil.copyfile(scr, dst)
            <span class="cmt">#open(dst,"w").write(open(scr,"r").read())
</span>            msg=<span class="str">'\n&lt;img border=\"0" src="'</span> + img+ <span class="str">'"&gt;&lt;/img&gt;\n'</span>
            fo.write(msg)
        <span class="kw">except</span> IOError, e:
            <span class="kw">print</span> <span class="str">"Unable to copy file. %s"</span> % e

        <span class="kw">except</span>:
            msg=<span class="str">"in exception: There is an except when write img log!"</span>
            <span class="kw">print</span> msg
            fo.write(msg)

<span class="kw">def</span> write_screenshot_log(logfile, img):
    <span class="kw">with</span> open(logfile, <span class="str">'a+'</span>) <span class="kw">as</span> fo:
        <span class="kw">print</span> <span class="str">"in screenshot def, Image path is: "</span> + img
        img_path,img_name=os.path.split(logfile)
        cmd = <span class="str">"copy %s %s"</span> % (img, img_path)
        os.system(cmd)
        path1,img_name=os.path.split(str(img))

        <span class="cmt">#print "Image path after copy is: " + img_name        
</span>        msg = <span class="str">'&lt;p&gt;Screen shot during test is &lt;a href='</span> +img_name + <span class="str">'&gt;here&lt;/a&gt;&lt;/p&gt;'</span>
        <span class="cmt">#print "Screenshot msg in screenshot log    is:     " + msg
</span>        fo.write(msg)

<span class="kw">def</span> cleanTestScript(testScript, removeSikExt = False):
    <span class="kw">if</span> <span class="str">".py.sikuli"</span> <span class="kw">in</span> testScript:
        testScript = testScript.replace(<span class="str">".py.sikuli"</span>, <span class="str">""</span>)

    <span class="kw">if</span> <span class="str">".sikuli"</span> <span class="kw">in</span> testScript:
        testScript = testScript.replace(<span class="str">".sikuli"</span>, <span class="str">""</span>)


    <span class="kw">if</span> removeSikExt:
        testScript = testScript.replace(<span class="str">".sikuli"</span>, <span class="str">""</span>)
    <span class="kw">print</span>(testScript)
    <span class="kw">return</span> testScript


<span class="kw">def</span> create_log_folder(test_case_script_name, testCase):

    timeStamp = str(time.strftime(<span class="str">"%H%M%S"</span>))
    test_case_script_name = cleanTestScript(test_case_script_name)
    <span class="kw">print</span>(test_case_script_name)
    log_path = _rootDir +<span class="str">"Logs\\"</span> + test_case_script_name <span class="cmt">#+ "/log"+timeStamp           </span>
    suite_path =_rootDir +<span class="str">"Logs\\"</span>
    failed_log_path = _rootDir +<span class="str">"Failed_Logs\\"</span>
    log_file= log_path +<span class="str">"\\"</span> +str(testCase)+ <span class="str">"-log.html"</span>

    <span class="kw">if</span> <span class="kw">not</span> os.path.exists(suite_path):
        <span class="kw">try</span>:
            <span class="kw">print</span> <span class="str">"before create logfile!"</span>
            os.mkdir(suite_path)
            <span class="kw">print</span> <span class="str">"log path created:  "</span> + suite_path

        <span class="kw">except</span>:
            <span class="kw">pass</span>

    <span class="kw">if</span> <span class="kw">not</span> os.path.exists(failed_log_path):
        <span class="kw">try</span>:
            <span class="kw">print</span> <span class="str">"before create logfile!"</span>
            os.mkdir(suite_path)
            <span class="kw">print</span> <span class="str">"log path created:  "</span> + suite_path

        <span class="kw">except</span>:
            <span class="kw">pass</span>

    <span class="kw">if</span> os.path.exists(log_path):
        <span class="kw">print</span> <span class="str">"log folder exists, will delete this folder!"</span>
        <span class="kw">try</span>:
            shutil.rmtree(log_path)
            <span class="kw">print</span> <span class="str">"Log folder is deleted!"</span>
        <span class="kw">except</span>:
            <span class="kw">print</span> <span class="str">"log folder is not deleted, will append to the previous log file!"</span>

    <span class="kw">try</span>:
        os.mkdir(log_path)
        <span class="kw">print</span> <span class="str">"log path created:  "</span> + log_path

    <span class="kw">except</span>:
        <span class="kw">pass</span> <span class="cmt"># fail silently if remote directory already exists    </span>
    write_log(log_file,<span class="str">"The common last modified on "</span>+_last_modifed)
    <span class="kw">return</span> log_file

<span class="kw">def</span> wait_find(y):
    i=<span class="dig">0</span>
    <span class="kw">while</span> (<span class="kw">not</span> exists(y)<span class="kw">and</span> i&lt;<span class="dig">5</span>):
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        i+=<span class="dig">1</span>
    <span class="kw">if</span> exists(y):
        <span class="skw">find</span>(y).highlight(<span class="dig">1</span>)
        <span class="kw">return</span> <span class="dig">1</span>
    <span class="kw">else</span>: <span class="kw">return</span> <span class="dig">0</span>

<span class="kw">def</span> wait_find_reg(reg,y):
    i=<span class="dig">0</span>
    <span class="kw">while</span> <span class="kw">not</span> reg.exists(y):
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        i+=<span class="dig">1</span>
    <span class="kw">if</span> reg.exists(y):
        reg.<span class="skw">find</span>(y).highlight(<span class="dig">1</span>)
        <span class="kw">return</span> <span class="dig">1</span>
    <span class="kw">else</span>: <span class="kw">return</span> <span class="dig">0</span>

<span class="kw">def</span> wait_click(y):
    i=<span class="dig">0</span>
    <span class="kw">while</span> (<span class="kw">not</span> exists(y) <span class="kw">and</span> i&lt;<span class="dig">5</span>):
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        i+=<span class="dig">1</span>
    <span class="kw">if</span> exists(y):
        <span class="skw">find</span>(y).highlight(<span class="dig">1</span>)
        <span class="skw">click</span>(y)
        <span class="kw">return</span> <span class="dig">1</span>
    <span class="kw">else</span>: <span class="kw">return</span> <span class="dig">0</span>

<span class="kw">def</span> verify_continue(logfile,image):
    x = wait_find(Pattern(image).similar(<span class="dig">0.90</span>))
    screen_shot=<span class="skw">capture</span>(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1440</span>,<span class="dig">900</span>)
    <span class="kw">if</span> x==<span class="dig">1</span>:
        write_log(logfile,<span class="str">"Following expected image was found:\n"</span>)
        write_img_log(logfile,str(image))
        write_screenshot_log(logfile,screen_shot)
        <span class="kw">return</span> <span class="dig">1</span>
    <span class="kw">else</span>:
        write_log(logfile,<span class="str">"Not able to find following image:\n"</span>)
        write_img_log(logfile, str(image))
        write_screenshot_log(logfile,str(screen_shot))
        <span class="kw">return</span> <span class="dig">0</span>

<span class="kw">def</span> verify_continue_with_similarity(logfile,image,similarity):
    x = wait_find(Pattern(image).similar(similarity))
    screen_shot=<span class="skw">capture</span>(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1440</span>,<span class="dig">900</span>)
    <span class="kw">if</span> x==<span class="dig">1</span>:
        write_log(logfile,<span class="str">"Following expected image was found:\n"</span>)
        write_img_log(logfile,str(image))
        write_screenshot_log(logfile,screen_shot)
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">110</span>))
        <span class="kw">return</span> <span class="dig">1</span>
    <span class="kw">else</span>:
        write_log(logfile,<span class="str">"Not able to find following image:\n"</span>)
        write_img_log(logfile, str(image))
        write_screenshot_log(logfile,str(screen_shot))
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">110</span>))
        <span class="kw">return</span> <span class="dig">0</span>

<span class="kw">def</span> verify(logfile,image):
    x = wait_find(Pattern(image).similar(<span class="dig">0.85</span>))
    screen_shot=<span class="skw">capture</span>(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1440</span>,<span class="dig">900</span>)
    <span class="kw">if</span> x==<span class="dig">1</span>:
        write_log(logfile,<span class="str">"Following expected image was found:\n"</span>)
        write_img_log(logfile,str(image))
        write_screenshot_log(logfile,screen_shot)
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">110</span>))
    <span class="kw">else</span>:
        write_log(logfile,<span class="str">"Not able to find following image:\n"</span>)
        write_img_log(logfile, str(image))
        write_screenshot_log(logfile,str(screen_shot))
        <span class="kw">raise</span> Exception(<span class="str">"Not able to find image "</span> + str(image))

<span class="kw">def</span> verify_exactly(logfile,image):
    x = wait_find(Pattern(image).similar(<span class="dig">0.99</span>))
    screen_shot=<span class="skw">capture</span>(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1440</span>,<span class="dig">900</span>)
    <span class="kw">if</span> x==<span class="dig">1</span>:
        write_log(logfile,<span class="str">"Following expected image was found:\n"</span>)
        write_img_log(logfile,str(image))
        write_screenshot_log(logfile,screen_shot)
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">110</span>))
    <span class="kw">else</span>:
        write_log(logfile,<span class="str">"Not able to find following image:\n"</span>)
        write_img_log(logfile, str(image))
        write_screenshot_log(logfile,str(screen_shot))
        <span class="kw">raise</span> Exception(<span class="str">"Not able to find image "</span> + str(image))

<span class="kw">def</span> locate_item_line_by_line(logfile,img):
    i=<span class="dig">0</span>; k=<span class="dig">0</span>

    <span class="kw">while</span> (<span class="kw">not</span> exists(img) <span class="kw">and</span> i&lt;<span class="dig">9</span>):
        <span class="kw">print</span> <span class="str">"In loop, i is:"</span> + str(i)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(Key.DOWN)
        <span class="skw">type</span>(Key.DOWN)
        <span class="skw">type</span>(Key.DOWN)
        i+=<span class="dig">1</span>
    mouseMove(Location(<span class="dig">1000</span>,<span class="dig">120</span>))
    <span class="kw">if</span> exists(img):
        <span class="skw">find</span>(img).highlight(<span class="dig">1</span>)
        write_log(logfile,<span class="str">"Following expected image was found:\n"</span>)
        write_img_log(logfile,str(img))
        write_log_with_screenshot(logfile,<span class="str">"See Screenshot:"</span>)
        k=<span class="dig">1</span>
    <span class="kw">else</span>:
        <span class="kw">print</span> <span class="str">"image not exists"</span>
        write_log(logfile, <span class="str">"Locate image in locate_item_line_by_line, not able to find image: "</span> +img)
        write_img_log(logfile, img)
        write_log_with_screenshot(logfile,<span class="str">"See Screenshot:"</span>)
        <span class="kw">raise</span> Exception(<span class="str">"Locate_item_line_by_line Exception: Not able to locate image: "</span> + img)

<span class="kw">def</span> locate_item_page_by_page(logfile,img):
    i=<span class="dig">0</span>
    <span class="kw">print</span> <span class="str">"img in locate_item_page_by_page is:"</span> + str(img)
    <span class="kw">while</span> (<span class="kw">not</span> exists(Pattern(img).similar(<span class="dig">0.90</span>)) <span class="kw">and</span> i&lt;<span class="dig">4</span>):
        <span class="skw">type</span>(Key.PAGE_DOWN)
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">110</span>))
        i+=<span class="dig">1</span>
        <span class="skw">sleep</span>(<span class="dig">3</span>)
    <span class="kw">if</span> exists(img):
        <span class="skw">find</span>(img).highlight(<span class="dig">1</span>)
        write_log(logfile, <span class="str">"Locate image in locate_item_line_by_line, image found: "</span> + str(img))
        write_img_log(logfile, img)
        write_log_with_screenshot(logfile,<span class="str">"See Screenshot:"</span>)
        k=<span class="dig">1</span>
    <span class="kw">else</span>:
        write_log(logfile, <span class="str">"Locate image in locate_item_line_by_line, not able to find image: "</span> + str(img))
        write_img_log(logfile, img)
        write_log_with_screenshot(logfile,<span class="str">"See Screenshot:"</span>)
        <span class="kw">raise</span> Exception(<span class="str">"Locate_item_page_by_page Exception: Not able to locate image: "</span> +  str(img))

<span class="kw">def</span> testScriptPaths():
     <span class="kw">print</span> <span class="str">"_rootDir= "</span>, _rootDir, <span class="str">"\n_thisScript= "</span>, _thisScript, <span class="str">"\n_commonDashDir= "</span>, _commonDashDir, <span class="str">"\n_config_file= "</span>, _config_file
     <span class="kw">print</span> <span class="str">"_email="</span>, _email, <span class="str">"\n_password"</span>, _password, <span class="str">"\n"</span>

     <span class="kw">print</span> _config.get(<span class="str">'Delete_history'</span>, <span class="str">'screen1'</span>)


<span class="kw">def</span> PassCase(logfile, test_case_id):
    test_script_name = str(logfile).split(<span class="str">"\\"</span>)[<span class="dig">3</span>]
    msg =   test_script_name + <span class="str">" - Test Case Passed!"</span>
    write_log_with_screenshot(logfile,msg)
    load_browser_with_url(_passed_link,logfile)
    write_log(_test_suite_log,msg)
    msg=<span class="str">"Tested URL:"</span> + _PF_link
    write_log(logfile,msg)
    msg=<span class="str">"Closing Privacyfix after test case finished...."</span>
    write_log(logfile, msg)
    <span class="skw">sleep</span>(<span class="dig">10</span>)
    close_pf_tabs(logfile)

<span class="kw">def</span> FailTestCase(logfile, test_case_id):

    test_script_name = str(logfile).split(<span class="str">"\\"</span>)[<span class="dig">3</span>]
    <span class="kw">print</span> <span class="str">"test_script_name is:"</span> + test_script_name

    msg = test_script_name + <span class="str">" - Test Case Failed!"</span>
    write_log_with_screenshot(logfile, msg)

    load_browser_with_url(_failed_link,logfile)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    write_log(_test_suite_log,msg)
    <span class="kw">print</span> <span class="str">"test suite log file is: "</span> + _test_suite_log
    write_log(logfile,<span class="str">"Tested URL:"</span> + _PF_link)
    <span class="skw">sleep</span>(<span class="dig">3</span>)

    <span class="cmt">#05/02/2014 -- copy failed log folder to _rootDir failed_logs folder
</span>    timeStamp = str(time.strftime(<span class="str">"%H%M%S"</span>))
    Failed_Logs_Folder = _rootDir + <span class="str">"Failed_Logs\\"</span> + test_script_name + <span class="str">"_"</span> + timeStamp +<span class="str">"\\"</span>
    src_folder=_rootDir+<span class="str">"Logs\\"</span>+ test_script_name+<span class="str">"\\"</span>
    <span class="kw">print</span> <span class="str">"src_folder is: "</span> + src_folder
    <span class="kw">print</span> <span class="str">"Failed_Logs_Folder is:"</span> + Failed_Logs_Folder
    <span class="kw">try</span>:
        shutil.copytree(src_folder, Failed_Logs_Folder)
    <span class="kw">except</span> shutil.Error:
        <span class="kw">print</span> <span class="str">"shutil error occurred."</span>+str(shutil.Error)
    close_pf_tabs(logfile)

<span class="kw">def</span> close_pf_tabs(logfile):
    write_log_with_screenshot(logfile, <span class="str">"Screenshot before close PF tabs:"</span>)
    pf_tab=<img src="1398774355412.png" />
    <span class="kw">if</span> exists(pf_tab):
        PF_tabs=findAll(pf_tab)
        <span class="kw">for</span> tab <span class="kw">in</span> PF_tabs:
            <span class="skw">sleep</span>(<span class="dig">2</span>)
            <span class="skw">click</span> (pf_tab)
            <span class="skw">sleep</span>(<span class="dig">1</span>)
            <span class="skw">type</span>(<span class="str">"w"</span>, Key.CTRL)
    write_log_with_screenshot(logfile, <span class="str">"PF tabs are closed"</span>)

<span class="kw">def</span> rememberPassword (logfile):
    <span class="kw">if</span> <span class="kw">not</span> exists(ff_icon):load_browser_with_url(<span class="str">""</span>,logfile)
    <span class="cmt">#click("1391019226848.png")
</span>    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(<span class="str">"t"</span>,KeyModifier.ALT)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(<span class="str">"o"</span>)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    verify(logfile,<img src="security1.png" />)
    <span class="skw">click</span>(<img src="security1.png" />)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="kw">if</span> exists  (Pattern(<img src="1390815475723.png" />).exact()):

        <span class="skw">click</span>(<img src="1390815475723.png" />)
        verify(logfile,<img src="1390815503711.png" />)

        <span class="skw">click</span>(<img src="1390815503711.png" />)
        write_log(logfile,<span class="str">"Remember password was successfully disabled. "</span> )
    <span class="kw">else</span> :
        <span class="skw">click</span>(<img src="1390815503711.png" />)
        write_log(logfile,<span class="str">"Remember password was already disabled."</span> )

<span class="cmt">#Reset account function                
</span><span class="kw">def</span> reset_data(logfile):
    reg=Region(<span class="dig">1333</span>,<span class="dig">52</span>,<span class="dig">101</span>,<span class="dig">51</span>)
    reg.highlight(<span class="dig">1</span>)
    <span class="kw">if</span> <span class="kw">not</span> exists(PF_icon):<span class="kw">return</span>
    load_browser_with_url(_reset_url,logfile)
    <span class="skw">sleep</span>(<span class="dig">3</span>)
    <span class="skw">click</span>(<img src="resetAddon.png" />)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">click</span>(<img src="1390825284047.png" />)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(<span class="str">"F"</span>, KeyModifier.ALT)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(<span class="str">"x"</span>)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="kw">if</span> exists(<img src="1390997737067-1.png" />):<span class="skw">click</span>(<img src="1390997737067-1.png" />)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    load_browser_with_url(_PF_link,logfile)
    wait_find(_PF_logo1)

    write_log(logfile,<span class="str">"ADD-ON reseted"</span> )


<span class="cmt">#Reset account function                
</span><span class="kw">def</span> reset_account(logfile):
    reg=Region(<span class="dig">1333</span>,<span class="dig">52</span>,<span class="dig">101</span>,<span class="dig">51</span>)
    reg.highlight(<span class="dig">1</span>)
    <span class="kw">if</span> <span class="kw">not</span> exists(PF_icon):<span class="kw">return</span>

    ClearBrowsingData(logfile)
    FacebookLogin(logfile)
    <span class="skw">sleep</span>(<span class="dig">3</span>)
    load_browser_with_url(_reset_url,logfile)
    <span class="skw">sleep</span>(<span class="dig">3</span>)

    <span class="skw">click</span>(<img src="resetAddon.png" />)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">click</span>(<img src="1390825284047.png" />)
    <span class="skw">sleep</span>(<span class="dig">1</span>)

    wait_click(<img src="1404770039709.png" />)

    <span class="skw">click</span>(<img src="1390825080898.png" />)
    <span class="skw">sleep</span>(<span class="dig">4</span>)
    write_log_with_screenshot(logfile,<img src="1404770039709.png" />)
    <span class="kw">if</span> exists(<img src="connecthere.png" />):

        wait_click(<img src="connecthere2.png" />)
        <span class="skw">sleep</span>(<span class="dig">4</span>)

        <span class="kw">if</span> exists(<img src="1390827287140.png" />):
            <span class="skw">click</span>(<img src="1390827287140.png" />)
        <span class="cmt">#if exists("1390825888908.png"):        
</span>            <span class="cmt">#click("1390825888908.png")
</span>        <span class="skw">sleep</span>(<span class="dig">2</span>)


    <span class="skw">type</span>(<span class="str">"F"</span>, KeyModifier.ALT)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(<span class="str">"x"</span>)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="kw">if</span> exists(<img src="1390997737067.png" />):<span class="skw">click</span>(<img src="1390997737067.png" />)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    load_browser_with_url(_PF_link,logfile)
    <span class="kw">if</span> exists(<img src="1390466175476-2.png" />):<span class="skw">click</span>(<img src="1390466175476-2.png" />)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.F5)
    waitVanish(Page_not_ready)
    <span class="skw">sleep</span>(<span class="dig">2</span>)

<span class="kw">def</span> ifPassword(log_file):
    reg=Region(<span class="dig">2</span>,<span class="dig">1</span>,<span class="dig">427</span>,<span class="dig">211</span>)

    reg1=Region(<span class="dig">481</span>,<span class="dig">196</span>,<span class="dig">451</span>,<span class="dig">134</span>)
    reg2=Region(<span class="dig">458</span>,<span class="dig">360</span>,<span class="dig">504</span>,<span class="dig">305</span>)
 <span class="cmt">#   if reg1.exists("1393580178856.png") or reg2.exists   
</span>    <span class="skw">sleep</span>(<span class="dig">5</span>)
    <span class="kw">if</span> <span class="kw">not</span> reg.exists(<img src="fixedIfpassword.png" />):
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(_password)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        write_log_with_screenshot(log_file,<span class="str">"linkedIn login."</span>)
        <span class="cmt">#click("1393248232619.png")
</span>        <span class="skw">type</span>(Key.ENTER)

<span class="kw">def</span> verify_link(logfile, link):
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(<span class="str">"l"</span>, Key.CTRL)
        <span class="skw">sleep</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(<span class="str">"c"</span>, Key.CTRL)
        x = Env.getClipboard()
        x = x.split(<span class="str">"//"</span>)[<span class="dig">1</span>]
        <span class="kw">if</span> (x <span class="kw">in</span> link):
            write_log_with_screenshot(logfile,<span class="str">"Link is correct"</span>)
        <span class="kw">else</span>:
            write_log_with_screenshot(logfile, <span class="str">"Link is:"</span> + x + <span class="str">"  Expect link is:"</span> + link)
            <span class="kw">raise</span> Exception(<span class="str">"Link is Incorrect"</span>)




<span class="kw">if</span> __name__ == <span class="str">"__main__"</span>:
    <span class="cmt"># This runs when executing PF_common directly, it will NOT run when importing.
</span>    <span class="cmt"># if indented (under the if statement, if not indented it will always run.)
</span>    testScriptPaths()
    <span class="cmt">#logfile="C:\\Automation_Firefox\\log.html"
</span>    <span class="cmt">#locate_google_section(logfile)
</span>        <span class="cmt">#protection_values()    
</span>        <span class="cmt">#lst=protection_values()        
</span>        <span class="cmt">#print lst[0]
</span>        <span class="cmt">#print lst[1]  
</span>    <span class="cmt">#RemoveExt("C:\\Automation_FF\\log.html")
</span>
    <span class="cmt">#InstallExtension("C:\\Automation_Firefox\\log.html")
</span>
    <span class="cmt">#create_log_folder("time_test","testCase_test_id_111")
</span>    <span class="cmt">#ClearBrowsingData()                #avoid install link autofill for _PF_link
</span>        <span class="cmt">#print "say hi from PF_common"
</span>    <span class="cmt">#load_browser_with_url("google.com")
</span>    logfile=<span class="str">"C:\\log111.html"</span>
    <span class="cmt">#GoogleLogin(logfile)                
</span><span class="cmt">#    locate_linkedIn_section(logfile)                
</span>    reset_account(logfile)
    <span class="cmt">#FacebookLogin(logfile)
</span>    <span class="cmt">#LinkedInLogIn(logfile)                     
</span>    <span class="cmt">#FailTestCase(logfile, "test_case_id")
</span>    <span class="cmt">#rite_log(_test_suite_log,"test")
</span>    <span class="cmt">#load_browser_with_url("google.com\n")
</span>    <span class="cmt">#print "Total time for installation is: " + str(datetime.now()-start_time</span>
</pre>
</body>
</html>
