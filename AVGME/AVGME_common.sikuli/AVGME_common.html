
<html>
   <head>
      <style type="text/css">
         .sikuli-code {
            font-size: 20px;
            font-family: "Osaka-mono", Monospace;
            line-height: 1.5em;
            display:table-cell;
            white-space: pre-wrap;       /* css-3 */
            white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
            white-space: -pre-wrap;      /* Opera 4-6 */
            white-space: -o-pre-wrap;    /* Opera 7 */
            word-wrap: break-word;       /* Internet Explorer 5.5+ */
            width: 99%;   /* remove horizontal scroll-bar when viewing in IE7 */
         }
         .sikuli-code img {
            vertical-align: middle;
            margin: 2px;
            border: 1px solid #ccc;
            padding: 2px;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            -moz-box-shadow: 1px 1px 1px gray;
            -webkit-box-shadow: 1px 1px 2px gray;
         }
         .kw {
            color: blue;
         }
         .skw {
            color: rgb(63, 127, 127);
         }

         .str {
            color: rgb(128, 0, 0);
         }

         .dig {
            color: rgb(128, 64, 0);
         }

         .cmt {
            color: rgb(200, 0, 200);
         }

         h2 {
            display: inline;
            font-weight: normal;
         }

         .info {
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-bottom: 20px;
            display: none;
         }

         a {
            color: #9D2900;
         }

         body {
            font-family: "Trebuchet MS", Arial, Sans-Serif;
         }

      </style>
   </head>
<body>
<div class="info">
<h2>AVGME_common.sikuli\AVGME_common.sikuli</h2> <a href="AVGME_common.sikuli\AVGME_common.zip">(Download this script)</a>
</div>
<pre class="sikuli-code">
<span class="cmt">#09.07-Fixed logging  functions. Created LoginTOApp and InstallExtention, UninstallExtention,AppOpen. AddNewAccount finished but will test later.
</span><span class="cmt">#23.06- Michael -  checkImage, readelement - read link from txt file and verify in avg elements are present on page 
</span><span class="cmt">#23.06- David - two new functions LoginTOApp() and set_hotkey()- 
</span>

<span class="kw">from</span> __future__ <span class="kw">import</span> with_statement
<span class="kw">import</span> ConfigParser
<span class="kw">import</span> logging
<span class="kw">import</span> shutil
<span class="kw">from</span> sikuli <span class="kw">import</span> *
<span class="kw">import</span> os, re
<span class="kw">from</span> datetime <span class="kw">import</span> datetime
<span class="kw">import</span> time
<span class="kw">from</span> random <span class="kw">import</span> randint
<span class="cmt">#This is the common script for Chrome
</span>_scriptName = <span class="str">"AVGME_common.sikuli"</span>

_saveLogToRW = False
_useAutoUser = False

_log_root = <span class="str">"C:\\Logs\\"</span>

<span class="kw">if</span> len(sys.argv) &gt; <span class="dig">1</span> <span class="kw">and</span> sys.argv[<span class="dig">1</span>] == <span class="str">"logrw"</span>:
    _useAutoUser = True
    _saveLogToRW = True

<span class="kw">print</span> <span class="str">"_saveLogToRW: "</span>, _saveLogToRW

<span class="kw">if</span> len(sys.argv) &gt; <span class="dig">1</span> <span class="kw">and</span> sys.argv[<span class="dig">1</span>] == <span class="str">"autoUser"</span>:
    _useAutoUser = True

<span class="kw">print</span> <span class="str">"_useAutoUser: "</span>, _useAutoUser

<span class="cmt">#_email = _config.get('Test_account', 'email1') 
</span><span class="cmt">#_password = _config.get('Test_account', 'pass1') 
</span><span class="cmt">#_email="lyemele@gmail.com"
</span><span class="cmt">#_password="qawsed1234"
</span>
<span class="cmt">#if _useAutoUser:
</span>    <span class="cmt"># when a Driver launches the TC's always use mzhang account.  
</span>    <span class="cmt">#_email = "mzhang0170@gmail.com"
</span>    <span class="cmt">#_password = "zhang0170"
</span>
_passed_link = <img src="dl.dropboxusercontent.com/u/40284694/passed.png" />
_failed_link =<img src="dl.dropboxusercontent.com/u/40284694/failed.png" />
_chrome_appx86=<span class="str">"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"</span>
_chrome_app=<span class="str">"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"</span>
_test_suite_log=<span class="str">"C://test_suite_log.html"</span>
_ch1=(<img src="1387227872882.png" />)
_ch2=(<img src="1387230266787.png" />)
redicon=(Pattern(<img src="1404895789903.png" />).similar(<span class="dig">0.91</span>))
_rootDir = os.path.dirname(sys.argv[<span class="dig">0</span>].replace(<span class="str">"/"</span>, <span class="str">"\\"</span>))
<span class="cmt"># can't get dynamicially since this will return the calling script (the Tescase Script)
</span><span class="cmt">#_scriptName = os.path.basename(os.path.splitext(sys.argv[0])[0]) + ".sikuli"
</span>
<span class="kw">print</span> <span class="str">"_scriptName: "</span>, _scriptName

<span class="kw">if</span> <span class="str">".sikuli"</span> <span class="kw">in</span> os.path.basename(_rootDir):
    <span class="cmt"># Running in command line returns the path including the sikuli script, different from IDE
</span>    _rootDir = os.path.dirname(_rootDir)
_rootDir = _rootDir + <span class="str">"\\"</span>
<span class="cmt">#_rootDir = "W:\\scripts\\web_app\\chrome\\"
</span><span class="cmt">#_scriptName = 
</span>_thisScript = _rootDir + _scriptName

_commonDashDir = _thisScript + <span class="str">"\\config_dash\\"</span>
_dirMap = {<span class="str">"dir"</span>:_commonDashDir}
_config_file= _commonDashDir + <span class="str">"config.txt"</span>



<span class="kw">if</span> os.path.isfile(_chrome_appx86):
    <span class="cmt">#check for x86 path (x64 bit) 
</span>    _chrome_app = _chrome_appx86

_chrome_app = _chrome_app + <span class="str">" --start-maximized"</span>

_config=ConfigParser.ConfigParser(_dirMap)
_config.read(_config_file)
<span class="cmt">#Clear chrome browser history Data finction. Clear a browser history through browsers hot keys
</span><span class="cmt">#last update 0304_2014 by Kathy
</span><span class="kw">def</span> ClearBrowsingData():
    reg1=Region(<span class="dig">146</span>,<span class="dig">108</span>,<span class="dig">298</span>,<span class="dig">57</span>)
    reg2=Region(<span class="dig">472</span>,<span class="dig">217</span>,<span class="dig">493</span>,<span class="dig">479</span>)

    time=_config.get(<span class="str">'Delete_history'</span>, <span class="str">'screen1'</span>)
    begin=_config.get(<span class="str">'Delete_history'</span>, <span class="str">'screen2'</span>)
    begin1=_config.get(<span class="str">'Delete_history'</span>, <span class="str">'screen3'</span>)
    load_browser_with_url(<span class="str">"chrome://history\n "</span>)
    reg1.highlight(<span class="dig">1</span>)
    clear_browsing_data=(<img src="common_clear_browsing_data.png" />)
    wait_find_reg(reg1,clear_browsing_data)
    reg1.<span class="skw">click</span>(clear_browsing_data)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    reg2.highlight(<span class="dig">1</span>)
    clear_browsing_history=(Pattern(<img src="common_browsing_history.png" />).similar(<span class="dig">0.95</span>))
    <span class="kw">if</span> reg2.exists(clear_browsing_history):<span class="skw">click</span>(clear_browsing_history);<span class="skw">sleep</span>(<span class="dig">1</span>)

    download_history=(Pattern(<img src="common_clear_download_history.png" />).similar(<span class="dig">0.95</span>))
    <span class="kw">if</span> reg2.exists(download_history):<span class="skw">click</span>(download_history);<span class="skw">sleep</span>(<span class="dig">1</span>)

    clear_cookies=(Pattern(<img src="common_clear_cookies.png" />).similar(<span class="dig">0.90</span>))
    <span class="kw">if</span> reg2.exists(clear_cookies):<span class="skw">click</span>(clear_cookies);<span class="skw">sleep</span>(<span class="dig">1</span>)

    empty_cache=(Pattern(<img src="common_clear_cached_images.png" />).similar(<span class="dig">0.95</span>))
    <span class="kw">if</span> reg2.exists(empty_cache):<span class="skw">click</span>(empty_cache);<span class="skw">sleep</span>(<span class="dig">1</span>)

    clear_password=(Pattern(<img src="common_clear_password.png" />).similar(<span class="dig">0.95</span>))
    <span class="kw">if</span> reg2.exists(clear_password):<span class="skw">click</span>(clear_password);<span class="skw">sleep</span>(<span class="dig">1</span>)

    clear_autofill=(Pattern(<img src="common_clear_auto_file.png" />).similar(<span class="dig">0.95</span>))
    <span class="kw">if</span> reg2.exists(clear_autofill):<span class="skw">click</span>(clear_autofill);<span class="skw">sleep</span>(<span class="dig">1</span>)

    hosted_app_data=(Pattern(<img src="common_clear_hosted_app_data.png" />).similar(<span class="dig">0.97</span>))
    <span class="kw">if</span> reg2.exists(hosted_app_data):<span class="skw">click</span>(hosted_app_data);<span class="skw">sleep</span>(<span class="dig">1</span>)

    reg2.<span class="skw">click</span>(time)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    reg2.<span class="skw">click</span>(begin1)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">find</span>(<img src="1391606325401.png" />).highlight(<span class="dig">1</span>) <span class="cmt">#--verify cleanup is successful</span>
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(<span class="str">"q"</span>, Key.CTRL+Key.SHIFT)
    load_browser_with_url(<span class="str">""</span>)


<span class="kw">def</span> write_log(logfile,msg):
    <span class="kw">with</span> open(logfile, <span class="str">'a+'</span>) <span class="kw">as</span> fo:
        fo.write(<span class="str">"\n&lt;p&gt; "</span> + str(datetime.now())+ <span class="str">":   "</span> + msg + <span class="str">" &lt;/p&gt;\n"</span>)


<span class="kw">def</span> write_log_with_screenshot(logfile,msg):
    write_log(logfile,msg)
    scr_shot=<span class="skw">capture</span>(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1440</span>,<span class="dig">900</span>)
    write_screenshot_log(logfile,scr_shot)



<span class="kw">def</span> write_screenshot_log(logfile, img):

    <span class="kw">with</span> open(logfile, <span class="str">'a+'</span>) <span class="kw">as</span> fo:
        <span class="cmt">#print "in screenshot def, Image path is: " + img        
</span>        img_path,img_name=os.path.split(logfile)
        cmd = <span class="str">"copy %s %s"</span> % (img, img_path)
        os.system(cmd)
        path1,img_name=os.path.split(str(img))

        <span class="cmt">#print "Image path after copy is: " + img_name        
</span>        msg = <span class="str">'&lt;p&gt;Screen shot during test is &lt;a href='</span> +img_name + <span class="str">'&gt;here&lt;/a&gt;&lt;/p&gt;'</span>
        <span class="cmt">#print "Screenshot msg in screenshot log    is:     " + msg
</span>        fo.write(msg)


<span class="kw">def</span> cleanTestScript(testScript, removeSikExt = False):
    <span class="kw">if</span> <span class="str">".py.sikuli"</span> <span class="kw">in</span> testScript:
        testScript = testScript.replace(<span class="str">".py.sikuli"</span>, <span class="str">""</span>)

    <span class="kw">if</span> <span class="str">".sikuli"</span> <span class="kw">in</span> testScript:
        testScript = testScript.replace(<span class="str">".sikuli"</span>, <span class="str">""</span>)


    <span class="kw">if</span> removeSikExt:
        testScript = testScript.replace(<span class="str">".sikuli"</span>, <span class="str">""</span>)
    <span class="kw">print</span>(testScript)
    <span class="kw">return</span> testScript


<span class="kw">def</span> create_log_folder(test_case_script_name, testCase):

    <span class="cmt">#timeStamp = str(time.strftime("%H%M%S"))
</span>    test_case_script_name = cleanTestScript(test_case_script_name)
    <span class="kw">print</span>(test_case_script_name)
    log_path = _rootDir +<span class="str">"Logs\\"</span> + test_case_script_name <span class="cmt">#+ "-"+timeStamp  </span>

    <span class="cmt">##### Ron's code, don't touch #######
</span>    <span class="kw">if</span> _saveLogToRW:
        log_path = _log_root + cleanTestScript(testScript, True)
    <span class="cmt">##### Ron's code, don't touch #######    
</span>
    suite_path=_rootDir +<span class="str">"Logs\\"</span>
    Failed_log_foler=_rootDir + <span class="str">"Failed_Logs\\"</span>
    log_file= log_path +<span class="str">"\\"</span> +str(testCase)+ <span class="str">"-log.html"</span>

    <span class="kw">if</span> <span class="kw">not</span> os.path.exists(suite_path):
        <span class="kw">try</span>:
            <span class="kw">print</span> <span class="str">"before create logfile folder!"</span>
            os.mkdir(suite_path)
            <span class="kw">print</span> <span class="str">"log path created:  "</span> + suite_path

        <span class="kw">except</span>:
            <span class="kw">pass</span>

    <span class="kw">if</span> <span class="kw">not</span> os.path.exists(Failed_log_foler):
        <span class="kw">try</span>:
            <span class="kw">print</span> <span class="str">"before create Failed_logs folder!"</span>
            os.mkdir(Failed_log_foler)
            <span class="kw">print</span> <span class="str">"Failed_Logs folder created:  "</span> + Failed_log_foler
        <span class="kw">except</span>:
            <span class="kw">pass</span>

    <span class="kw">if</span> os.path.exists(log_path):
        <span class="kw">print</span> <span class="str">"log folder exists, will delete this folder!"</span>
        <span class="kw">try</span>:
            shutil.rmtree(log_path)
            <span class="kw">print</span> <span class="str">"Log folder is deleted!"</span>

        <span class="kw">except</span>:
            <span class="kw">print</span> <span class="str">"log folder is not deleted, will append to the previous log file!"</span>

    <span class="kw">try</span>:
        <span class="kw">print</span> <span class="str">"before create logfile!"</span>
        os.mkdir(log_path)
        <span class="kw">print</span> <span class="str">"log path created:  "</span> + log_path

    <span class="kw">except</span>:
        <span class="kw">pass</span> <span class="cmt"># fail silently if remote directory already exists    </span>
    <span class="cmt">#write_log(log_file,"The common last modified"+_last_modifed)      
</span>    <span class="kw">return</span> log_file

<span class="kw">def</span> write_img_log(logfile,img):
    <span class="kw">print</span> <span class="str">"img is:"</span> + img
    path_common=_rootDir + _scriptName + <span class="str">"\\"</span>
    <span class="kw">print</span> <span class="str">"path_common is: "</span> + path_common

    dst_path, script_name =os.path.split(logfile)
    <span class="kw">print</span> <span class="str">"dst_path is: "</span> + dst_path
    <span class="kw">print</span> <span class="str">"script_name is"</span> + script_name

    script_path, script_name=os.path.split(dst_path)
    path_script=_rootDir + script_name + <span class="str">".sikuli\\"</span>
    <span class="kw">print</span> <span class="str">"path_script is: "</span> + path_script

    src_file=<span class="str">""</span>
    <span class="kw">if</span> <span class="kw">not</span> <span class="str">"\\"</span> <span class="kw">in</span> img: <span class="cmt">#for the img doesn't have path, only have file name, add path to get full path for source file</span>
        <span class="kw">if</span> os.path.exists(path_common + img): src_file = path_common + img;<span class="kw">print</span> <span class="str">"img is from common folder, full path:"</span> + src_file
        <span class="kw">if</span> os.path.exists(path_script + img): src_file = path_script + img;<span class="kw">print</span> <span class="str">"img is from script folder, full path:"</span> + src_file
        <span class="kw">print</span> <span class="str">"img without path, src_file is:"</span> + src_file
        dst_file = dst_path + <span class="str">"\\"</span> + img  <span class="cmt">#destination file with path</span>
        <span class="kw">print</span> <span class="str">"dst_file is: "</span> + dst_file
    <span class="kw">else</span>: <span class="cmt">#for the img with full path, change the path to destination path for copy</span>
        src_file = img
        path, img_name=os.path.split(img)
        dst_file = dst_path + <span class="str">"\\"</span> + img_name <span class="cmt">#destination file with path</span>
        <span class="kw">print</span> <span class="str">"img file has full path, src_file is:"</span> + src_file
        <span class="kw">print</span> <span class="str">"dst_file is: "</span> + dst_file
    <span class="cmt">#copy the file to log folder 
</span>    shutil.copyfile(src_file, dst_file)

    <span class="cmt">#write to logfile
</span>    <span class="kw">with</span> open(logfile, <span class="str">'a+'</span>) <span class="kw">as</span> fo:
        msg=<span class="str">'\n&lt;img border=\"0" src="'</span> + dst_file+ <span class="str">'"&gt;&lt;/img_new&gt;\n'</span>
        fo.write(msg)


<span class="kw">def</span> wait_find(y):
    i=<span class="dig">0</span>
    <span class="kw">while</span> (<span class="kw">not</span> exists(y)<span class="kw">and</span> i&lt;<span class="dig">5</span>):
        <span class="skw">sleep</span>(<span class="dig">2</span>)

        i+=<span class="dig">1</span>
    <span class="kw">if</span> exists(y):
        <span class="skw">find</span>(y)<span class="cmt">#.highlight(1)</span>
        <span class="kw">return</span> <span class="dig">1</span>
    <span class="kw">else</span>: <span class="kw">return</span> <span class="dig">0</span>

<span class="kw">def</span> wait_find_reg(reg,y):
    i=<span class="dig">0</span>
    <span class="kw">while</span> (<span class="kw">not</span> reg.exists(y)<span class="kw">and</span> i&lt;<span class="dig">5</span>):
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        i+=<span class="dig">1</span>
    <span class="kw">if</span> reg.exists(y):
        reg.<span class="skw">find</span>(y).highlight(<span class="dig">1</span>)
        <span class="kw">return</span> <span class="dig">1</span>
    <span class="kw">else</span>: <span class="kw">return</span> <span class="dig">0</span>

<span class="kw">def</span> wait_click(y):
    i=<span class="dig">0</span>
    <span class="kw">while</span> (i&lt;<span class="dig">5</span>):
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        i+=<span class="dig">1</span>
    <span class="kw">if</span> exists(y):
        <span class="skw">find</span>(y).highlight(<span class="dig">1</span>)
        <span class="skw">click</span>(y)
        <span class="kw">return</span> <span class="dig">1</span>
    <span class="kw">else</span>: <span class="kw">return</span> <span class="dig">0</span>

<span class="kw">def</span> verify_continue(logfile,image):

    x = wait_find(Pattern(image).similar(<span class="dig">0.90</span>))

    screen_shot=<span class="skw">capture</span>(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1440</span>,<span class="dig">900</span>)
    <span class="kw">if</span> x==<span class="dig">1</span>:
        write_log(logfile,<span class="str">"Following expected image was found:\n"</span>)
        write_img_log(logfile,str(image))
        write_screenshot_log(logfile,screen_shot)
        <span class="kw">return</span> <span class="dig">1</span>
    <span class="kw">else</span>:
        write_log(logfile,<span class="str">"Not able to find following image:\n"</span>)
        write_img_log(logfile, str(image))
        write_screenshot_log(logfile,str(screen_shot))
        <span class="kw">return</span> <span class="dig">0</span>

<span class="kw">def</span> verify_continue_with_similarity(logfile,image,similarity):

    x = wait_find(Pattern(image).similar(similarity))

    screen_shot=<span class="skw">capture</span>(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1440</span>,<span class="dig">900</span>)
    <span class="kw">if</span> x==<span class="dig">1</span>:
        write_log(logfile,<span class="str">"Following expected image was found:\n"</span>)
        write_img_log(logfile,str(image))
        write_screenshot_log(logfile,screen_shot)
        <span class="kw">return</span> <span class="dig">1</span>
    <span class="kw">else</span>:
        write_log(logfile,<span class="str">"Not able to find following image:\n"</span>)
        write_img_log(logfile, str(image))
        write_screenshot_log(logfile,str(screen_shot))
        <span class="kw">return</span> <span class="dig">0</span>

<span class="kw">def</span> verify(logfile,image):

    x = wait_find(Pattern(image).similar(<span class="dig">0.80</span>))
    screen_shot=<span class="skw">capture</span>(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1440</span>,<span class="dig">900</span>)
    <span class="kw">if</span> x==<span class="dig">1</span>:
        write_log(logfile,<span class="str">"Following expected image was found"</span>)
        write_img_log(logfile,str(image))
        write_screenshot_log(logfile,screen_shot)

    <span class="kw">else</span>:
        write_log(logfile,<span class="str">"Not able to find following image"</span>)
        write_img_log(logfile, str(image))
        write_screenshot_log(logfile,str(screen_shot))
        <span class="kw">raise</span> Exception(<span class="str">"Not able to find image "</span> + str(image))

<span class="kw">def</span> verify_exactly(logfile,image):

    x = wait_find(Pattern(image).similar(<span class="dig">0.99</span>))
    screen_shot=<span class="skw">capture</span>(<span class="dig">0</span>,<span class="dig">0</span>,<span class="dig">1440</span>,<span class="dig">900</span>)
    <span class="kw">if</span> x==<span class="dig">1</span>:
        write_log(logfile,<span class="str">"Following expected image was found:\n"</span>)
        write_img_log(logfile,str(image))
        write_screenshot_log(logfile,screen_shot)
    <span class="kw">else</span>:
        write_log(logfile,<span class="str">"Not able to find following image:\n"</span>)
        write_img_log(logfile, str(image))
        write_screenshot_log(logfile,str(screen_shot))
        <span class="kw">raise</span> Exception(<span class="str">"Not able to find image "</span> + str(image))

<span class="kw">def</span> load_browser_with_url(link):
    reg1=Region(<span class="dig">1268</span>,<span class="dig">25</span>,<span class="dig">171</span>,<span class="dig">35</span>)
    start_time=datetime.now()
    reg1.highlight(<span class="dig">1</span>)
    <span class="kw">if</span> <span class="kw">not</span> reg1.exists(<img src="1393420720867.png" />):
        <span class="cmt">#write_log(logfile, "total time detecting chrome not open is: " + str(datetime.now()-start_time))
</span>        App.open(_chrome_app)
        <span class="kw">print</span> <span class="str">"total time open chrome is: "</span> + str(datetime.now()-start_time)
        wait_find_reg(reg1,<img src="1393420720867.png" />)
        <span class="kw">if</span> exists(<img src="1395170923573.png" />):<span class="skw">click</span>(<img src="1395170923573.png" />)
        <span class="kw">print</span> <span class="str">"total time detecting chrome is loaded: "</span> + str(datetime.now()-start_time)

    <span class="kw">else</span>:
        switchApp(<span class="str">"Google Chrome"</span>)
        <span class="kw">if</span> exists(<img src="1395170923573-1.png" />):<span class="skw">click</span>(<img src="1395170923573-1.png" />)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(<span class="str">'l'</span>, KEY_CTRL)
    <span class="skw">type</span>(link+<span class="str">"\n"</span>)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    wait_find(<img src="1403263925018.png" />)
    mouseMove(Location(<span class="dig">1000</span>,<span class="dig">100</span>))

<span class="kw">def</span> locate_item_line_by_line(logfile,img):
    i=<span class="dig">0</span>
    k=<span class="dig">0</span>
    <span class="kw">while</span> (<span class="kw">not</span> exists(img) <span class="kw">and</span> i&lt;<span class="dig">12</span>):
        <span class="skw">type</span>(Key.DOWN)
        <span class="skw">type</span>(Key.DOWN)
        <span class="skw">type</span>(Key.DOWN)
        mouseMove(Location(<span class="dig">1000</span>,<span class="dig">100</span>))
        i+=<span class="dig">1</span>
    <span class="kw">if</span> exists(img):
        <span class="skw">find</span>(img).highlight(<span class="dig">1</span>)
        write_log(logfile, <span class="str">"Locate image in locate_item_line_by_line, image found: "</span> +img)
        write_img_log(logfile, img)
        write_log_with_screenshot(logfile,<span class="str">"See Screenshot:"</span>)
        k=<span class="dig">1</span>
    <span class="kw">else</span>:
        write_log(logfile, <span class="str">"Locate image in locate_item_line_by_line, not able to find image: "</span> +img)
        write_img_log(logfile, img)
        write_log_with_screenshot(logfile,<span class="str">"See Screenshot:"</span>)
        <span class="kw">raise</span> Exception(<span class="str">"Locate_item_line_by_line Exception: Not able to locate image: "</span> + img)

<span class="kw">def</span> locate_item_page_by_page(logfile,img):
    i=<span class="dig">0</span>
    <span class="kw">while</span> (<span class="kw">not</span> exists(img) <span class="kw">and</span> i&lt;<span class="dig">6</span>):
        <span class="skw">type</span>(Key.PAGE_DOWN)
        mouseMove(Location(<span class="dig">200</span>,<span class="dig">50</span>))
        <span class="skw">sleep</span>(<span class="dig">3</span>)
        i+=<span class="dig">1</span>

    <span class="kw">if</span> exists(img):
        <span class="skw">find</span>(img).highlight(<span class="dig">1</span>)
        write_log(logfile, <span class="str">"Locate image in locate_page_by_page, image found: "</span> +img)
        write_img_log(logfile, img)
        write_log_with_screenshot(logfile,<span class="str">"See Screenshot:"</span>)
        k=<span class="dig">1</span>
    <span class="kw">else</span>:
        write_log(logfile, <span class="str">"Locate image in locate_page_by_page, not able to find image: "</span> +img)
        write_img_log(logfile, img)
        write_log_with_screenshot(logfile,<span class="str">"See Screenshot:"</span>)
        <span class="kw">raise</span> Exception(<span class="str">"Locate_item_page_by_page Exception: Not able to locate image: "</span> + img)

<span class="kw">def</span> testScriptPaths():
     <span class="kw">print</span> <span class="str">"_rootDir= "</span>, _rootDir, <span class="str">"\n_thisScript= "</span>, _thisScript, <span class="str">"\n_commonDashDir= "</span>, _commonDashDir, <span class="str">"\n_config_file= "</span>, _config_file
     <span class="kw">print</span> _config.get(<span class="str">'Delete_history'</span>, <span class="str">'screen1'</span>)


<span class="kw">def</span> PassCase(log_file, test_case_id):
    load_browser_with_url(_passed_link)
    msg=str(test_case_id) +<span class="str">' Test Case Passed!'</span>
    write_log_with_screenshot(log_file,msg)
    write_log(_test_suite_log,msg)
    msg=<span class="str">"Tested URL:"</span>
    write_log(log_file,msg)
    msg=<span class="str">"Closing browser after test case finished...."</span>
    write_log(log_file, msg)
    <span class="skw">sleep</span>(<span class="dig">15</span>)

    <span class="cmt">#msg="browser closed"
</span>    <span class="cmt">#write_log_with_screenshot(log_file, msg)    
</span>    <span class="cmt">#close_browser(log_file)
</span>
<span class="kw">def</span> FailTestCase(logfile, test_case_id):
    load_browser_with_url(_failed_link)
    msg=test_case_id + <span class="str">' Test Case failed!'</span>
    write_log_with_screenshot(logfile, msg)
    write_log(_test_suite_log,msg)
    <span class="kw">print</span> <span class="str">"test suite log file is: "</span> + _test_suite_log
    write_log(logfile,<span class="str">"Tested URL:"</span> )


    <span class="skw">sleep</span>(<span class="dig">2</span>)

    test_script_name = str(logfile).split(<span class="str">"\\"</span>)[<span class="dig">3</span>]
    <span class="kw">print</span> <span class="str">"test_script_name is:"</span> + test_script_name

    msg = test_script_name + <span class="str">" - Test Case Failed!"</span>
    write_log_with_screenshot(logfile, msg)
    write_log(_test_suite_log,msg)
    <span class="kw">print</span> <span class="str">"test suite log file is: "</span> + _test_suite_log

    <span class="skw">sleep</span>(<span class="dig">3</span>)
    timeStamp = str(time.strftime(<span class="str">"%H%M%S"</span>))
    Failed_Logs_Folder = _rootDir + <span class="str">"Failed_Logs\\"</span> + test_script_name + <span class="str">"_"</span> + timeStamp +<span class="str">"\\"</span>
    src_folder=_rootDir+<span class="str">"Logs\\"</span>+ test_script_name+<span class="str">"\\"</span>
    <span class="kw">print</span> <span class="str">"src_folder is: "</span> + src_folder
    <span class="kw">print</span> <span class="str">"Failed_Logs_Folder is:"</span> + Failed_Logs_Folder
    <span class="kw">try</span>:
        shutil.copytree(src_folder, Failed_Logs_Folder)
    <span class="kw">except</span> shutil.Error:
        <span class="kw">print</span> <span class="str">"shutil error occurred."</span>
    <span class="cmt">#msg="browser closed"
</span>    <span class="cmt">#write_log_with_screenshot(logfile, msg)
</span>    <span class="cmt">#close_browser(logfile)
</span>
<span class="kw">def</span> close_browser(logfile):
    verify(logfile,<img src="1388806538311.png" />)
    <span class="skw">click</span>(<img src="1388806538311.png" />)
    verify(logfile,<img src="1388806596083.png" />)
    <span class="skw">click</span>(<img src="1388806596083.png" />)
    write_log_with_screenshot(logfile, <span class="str">"The above test case is done, browser closed!"</span>)

<span class="cmt">#disable autofill for chrome browser
</span><span class="kw">def</span> disable_autofill(logfile):
    load_browser_with_url(<span class="str">"chrome://settings/"</span>)
    search_field=(<img src="1397084129692.png" />)
    wait_find(search_field)
    <span class="skw">click</span>(search_field)
    <span class="skw">type</span>(<span class="str">"Password"</span>)

    auto_complete1=(<img src="auto_comlete_url-1.png" />)

    <span class="kw">if</span> exists(Pattern(auto_complete1).similar(<span class="dig">0.95</span>)):
        <span class="skw">find</span>(auto_complete1).highlight(<span class="dig">1</span>)
        <span class="skw">click</span>(auto_complete1)
    auto_complete2=(<img src="1395321409938-1.png" />)

    <span class="kw">if</span> exists(Pattern(auto_complete2).similar(<span class="dig">0.95</span>)):
        <span class="skw">find</span>(auto_complete2).highlight(<span class="dig">1</span>)
        <span class="skw">click</span>(auto_complete2)
    <span class="skw">sleep</span>(<span class="dig">1</span>)

    <span class="cmt">#disable password autofill
</span>
    enable_autofill_password=(<img src="enable_autofill_password-1.png" />)
    offer_save_password=(<img src="1397084314994.png" />)


    <span class="kw">if</span> exists(Pattern(enable_autofill_password).similar(<span class="dig">0.95</span>)):
        <span class="skw">find</span>(enable_autofill_password).highlight(<span class="dig">1</span>)
        <span class="skw">click</span>(enable_autofill_password)

    <span class="kw">if</span> exists(Pattern(offer_save_password).similar(<span class="dig">0.95</span>)):
        <span class="skw">find</span>(offer_save_password).highlight(<span class="dig">1</span>)
        <span class="skw">click</span>(offer_save_password)

<span class="kw">def</span> add_sites(p):
    sites=_thisScript+<span class="str">"\\"</span>+<span class="str">"login_signup.txt"</span>
    <span class="kw">with</span> open(sites, <span class="str">'r'</span>) <span class="kw">as</span> f:
        site_list = [line.strip() <span class="kw">for</span> line <span class="kw">in</span> f]
    <span class="kw">return</span> site_list[p]


image=<span class="str">"avgme-mapping"</span>
<span class="kw">def</span> readelement(link,image,logfile):
    load_browser_with_url(link)
    <span class="skw">wait</span>(<span class="dig">10</span>)
    <span class="skw">type</span>(Key.F12)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(<span class="str">"f"</span>, KeyModifier.CTRL)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(image)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="cmt">#type(Key.ENTER)
</span>    <span class="kw">if</span> exists (<img src="1403508890042.png" />):
        hover(<img src="1403508890042.png" />)
    <span class="skw">wait</span>(<span class="dig">2</span>)
    username=(<img src="1403525464402.png" />)
    password=(<img src="1403525481129.png" />)
    <span class="kw">if</span> exists (username):
        msg=(<span class="str">"element email from site "</span> +<span class="str">" ---------------was found"</span>)
        <span class="kw">print</span> (msg)
        write_log(logfile,msg)
        <span class="kw">if</span> exists(Pattern(<img src="1403508994132.png" />).similar(<span class="dig">0.90</span>)):
            msg=(<span class="str">"image email from site "</span> +  <span class="str">" ---------------was found"</span>)
            <span class="kw">print</span> (msg)
            write_log(logfile,msg)
    <span class="kw">else</span>:
        msg=(<span class="str">"element email from site "</span> + <span class="str">" ---------------was not found"</span>)
        <span class="kw">print</span> (msg)
        write_log(logfile,msg)
    <span class="skw">type</span>(Key.ENTER)
    <span class="kw">if</span> exists (password):
        msg=(<span class="str">"element password from  site "</span> +  <span class="str">" ---------------was found"</span>)
        <span class="kw">print</span> (msg)
        write_log(logfile,msg)
        <span class="kw">if</span> exists(Pattern(<img src="1403509007657.png" />).similar(<span class="dig">0.90</span>)):
            msg=(<span class="str">"image password from  site "</span> +  <span class="str">" ---------------was found"</span>)
            <span class="kw">print</span> (msg)
            write_log(logfile,msg)
    <span class="kw">else</span>:
        msg=(<span class="str">"element password from  site "</span> + <span class="str">" ---------------was not found"</span>)
        <span class="kw">print</span> (msg)
        write_log(logfile,msg)


    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(Key.F12)


<span class="kw">def</span> fill_fields(logfile):
    Close=(<img src="1405584053375.png" />)
    Topbar=( <img src="1405584104731.png" />)
    greenlock=(<img src="1405582009901.png" />)
    <span class="cmt">#greenlock1=("")
</span>    count = <span class="dig">0</span>
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="kw">if</span> <span class="kw">not</span> exists (greenlock):
        <span class="kw">return</span> <span class="dig">0</span>

    lock=findAll(greenlock)
    <span class="kw">for</span> greenlock <span class="kw">in</span> lock:
        <span class="skw">click</span>(greenlock)
        <span class="skw">wait</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(<span class="str">"michael.scott.avg@gmail.com"</span>)
        <span class="skw">wait</span>(<span class="dig">1</span>)

        count += <span class="dig">1</span>
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="kw">if</span> verify_continue(logfile,Topbar)==<span class="dig">1</span>:
        <span class="skw">click</span>(Close)

    <span class="kw">return</span> count

<span class="kw">def</span> verifyAccount(logfile):
    Accounts=(<img src="1405585354472.png" />)
    Item=(<img src="1405585496047.png" />)
    Address=(<img src="1405587024826.png" />)
    Username=(<img src="1405587244668.png" />)
    Remove=(<img src="1405587728444.png" />)
    Delete=(<img src="1405587762833.png" />)
    NoAccounts=(<img src="1405588247786.png" />)
    Trash=(<img src="1405343738103.png" />)


    data=<span class="str">""</span>
    <span class="skw">click</span>(redicon)
    <span class="skw">wait</span>(<span class="dig">3</span>)
    <span class="kw">if</span> exists(Accounts):
        <span class="skw">click</span>(Accounts)
    <span class="kw">if</span> verify_continue(logfile,Item) ==<span class="dig">1</span>:
        <span class="skw">click</span>(Item)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        <span class="skw">click</span>(Address)
        <span class="skw">type</span>(<span class="str">"a"</span>, KeyModifier.CTRL)
        <span class="skw">wait</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(<span class="str">"c"</span>, KeyModifier.CTRL)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        data=Env.getClipboard()
        write_log(logfile,<span class="str">"Stored Address was----------"</span>+str(data))
        <span class="skw">click</span>(Username)
        <span class="skw">wait</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(<span class="str">"a"</span>, KeyModifier.CTRL)
        <span class="skw">wait</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(<span class="str">"c"</span>, KeyModifier.CTRL)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        data1=Env.getClipboard()
        write_log(logfile,<span class="str">"Stored Username was----------"</span>+str(data1))
        <span class="skw">click</span>(Remove)
        <span class="skw">wait</span>(<span class="dig">1</span>)
        <span class="skw">click</span>(Delete)

    <span class="kw">elif</span> verify_continue(logfile,Item) ==<span class="dig">0</span>:
        write_log(logfile,<span class="str">"Site data wasnt stored"</span>)
    <span class="kw">while</span> exists(Item):
        hover(Item)
        verify(logfile,Trash)
        <span class="skw">click</span>(Trash)
        verify(logfile,Delete)
        <span class="skw">click</span>(Delete)


    verify_continue(logfile,NoAccounts)
    <span class="kw">return</span> data








<span class="kw">def</span> checkImage(logfile):
    sites=_thisScript+<span class="str">"\\"</span>+<span class="str">"login_signup.txt"</span>
    <span class="kw">with</span> open(sites, <span class="str">'r'</span>) <span class="kw">as</span> f:
        line = f.readline()
        <span class="kw">while</span> line:
            write_log(logfile,<span class="str">"-----------------------------------------------------------------------------------------------"</span>)
            readelement(line,image,logfile)
            write_log_with_screenshot(logfile,line)
            <span class="kw">print</span> line
            <span class="kw">if</span> fill_fields(logfile)&gt;=<span class="dig">1</span>:

                verifyAccount(logfile)
            line = f.readline()
        f.closed

<span class="kw">def</span> set_hotkey():
    <span class="kw">print</span>(<span class="str">"1"</span>)
    load_browser_with_url(<span class="str">"chrome://extensions/"</span>)
    <span class="skw">click</span>(<img src="1403523893400.png" />)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">click</span>(<img src="1403524300016.png" />)
    <span class="skw">sleep</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(<span class="str">"m"</span>, KEY_CTRL)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    <span class="skw">type</span>(Key.ESC)
    close_browser(log_file)

<span class="kw">def</span> LoginTOApp(logfile):

    login=(<img src="1405340124887.png" />)
    password=(<img src="1405340138333.png" />)
    masterpassword=(<img src="1406545572859.png" />)

    loggedin=(<img src="1404910191023.png" />)

    <span class="cmt">#type("m", KEY_CTRL)
</span>    <span class="kw">print</span>(<span class="str">"LoginTOApp"</span>)
    load_browser_with_url(<span class="str">"http://www.google.com/"</span>)
    <span class="skw">sleep</span>(<span class="dig">6</span>)
    <span class="skw">click</span>(redicon)
    <span class="skw">sleep</span>(<span class="dig">6</span>)

    <span class="kw">if</span> exists(loggedin):
        write_log(logfile,<span class="str">"You are alredy logged into AVG Me"</span>)
        <span class="kw">return</span>
    <span class="kw">if</span> exists(login):
        <span class="skw">click</span>(login)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        <span class="skw">type</span>(<span class="str">"michael.scott.avg@gmail.com"</span>)
    <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="kw">if</span> exists(password):
        <span class="skw">click</span>(password)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        <span class="skw">type</span>(<span class="str">"US!pf.avg"</span>)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        <span class="skw">type</span>(Key.ENTER)
    <span class="kw">if</span> exists(masterpassword):
        <span class="skw">click</span>(masterpassword)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        <span class="skw">type</span>(<span class="str">"US!pf.avg"</span>)
        <span class="skw">sleep</span>(<span class="dig">2</span>)
        <span class="skw">type</span>(Key.ENTER)
    <span class="skw">sleep</span>(<span class="dig">2</span>)
    write_log_with_screenshot(logfile,<span class="str">"See Screenshot:"</span>)
    <span class="skw">type</span>(Key.ESC)
    write_log(logfile,<span class="str">"You are succesfully logged in"</span>)



<span class="kw">def</span> InstallExtention(logfile):

        Free=(<img src="1404895678910.png" />)
        Add=(<img src="1404895706525.png" />)
        Options=(Pattern(<img src="1404895861227.png" />).similar(<span class="dig">0.91</span>))
        Server=( <img src="1409301894446.png" />)
        Save=(<img src="1404896133634.png" />)
        AvgPass=(<img src="1404898394393.png" />)
        load_browser_with_url(<span class="str">""</span>)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        <span class="kw">if</span> exists (redicon):
            write_log(logfile,<span class="str">"Extention was installed"</span>)
            <span class="kw">return</span>

        load_browser_with_url(<span class="str">"https://chrome.google.com/webstore/detail/avgme/ifbiffgejacbblpoellfaeijobciillc?authuser=0"</span>)
        <span class="skw">wait</span>(<span class="dig">6</span>)
        verify(logfile,Free)
        <span class="skw">click</span>(Free)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        verify(logfile,Add)
        <span class="skw">click</span>(Add)
        <span class="skw">wait</span>(<span class="dig">10</span>)
        <span class="cmt">#verify(logfile,redicon)
</span>        <span class="skw">rightClick</span>(redicon)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        <span class="cmt">#hover(Options)
</span>        <span class="skw">click</span>(Options)
        <span class="skw">wait</span>(<span class="dig">3</span>)
        <span class="kw">if</span> exists (Server):
            <span class="skw">click</span>(Server)
            <span class="skw">wait</span>(<span class="dig">2</span>)
            <span class="skw">type</span>(<span class="str">"a"</span>, KeyModifier.CTRL)
            <span class="skw">wait</span>(<span class="dig">2</span>)
            <span class="skw">type</span>(Key.DELETE)
            <span class="skw">type</span>(<span class="str">"http://atltavgme01.cloud-int.avg.com"</span>)
            <span class="skw">wait</span>(<span class="dig">2</span>)
            <span class="skw">click</span>(Save)
        <span class="cmt">#verify(logfile,redicon)
</span>        write_log(logfile,<span class="str">"Extention was installed successfully"</span>)
        write_log_with_screenshot(logfile,<span class="str">"See Screenshot:"</span>)



<span class="kw">def</span> UninstallExtention(logfile):
    load_browser_with_url(<span class="str">"https://google.com//"</span>)
    <span class="skw">wait</span>(<span class="dig">5</span>)
    <span class="kw">if</span> <span class="kw">not</span> exists (redicon):
        write_log(logfile,<span class="str">"Extention was uninstalled"</span>)
        <span class="kw">print</span>(<span class="str">"Extention was uninstalled"</span>)
        <span class="kw">return</span>
    <span class="skw">rightClick</span>(redicon)
    <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="skw">click</span>(<img src="1404912423421.png" />)
    <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="skw">click</span>(<img src="1404912455198.png" />)
    <span class="kw">if</span> <span class="kw">not</span> exists (redicon):
        write_log(logfile,<span class="str">"Extention was installed successfully"</span>)
        <span class="kw">print</span>(<span class="str">"Extention was uninstalled successfully"</span>)

<span class="kw">def</span> AppOpen(logfile):
    <span class="kw">if</span> <span class="kw">not</span> exists (redicon):
        write_log(logfile,<span class="str">"Opening browser"</span>)
        load_browser_with_url(<span class="str">"https://google.com//"</span>)
    <span class="cmt">#verify(logfile,redicon)
</span>    <span class="kw">if</span> <span class="kw">not</span> exists(<img src="1404898394393.png" />):
        <span class="skw">click</span>(redicon)
        write_log(logfile,<span class="str">"Opening app"</span>)



<span class="kw">def</span> AddNewAccount(logfile) :
    GmailAcc=(<img src="1405341461409.png" />)
    AddNew=(<img src="1404913650255.png" />)
    Name=(<img src="1405685022627.png" />)
    Address=(<img src="1404913768988.png" />)
    Username=(<img src="1404913804945.png" />)
    Passowrd=(<img src="1405338004216.png" />)
    SaveChanges=(<img src="1404914048588.png" />)
    Stored=( <img src="1406207698374.png" />)
    Advanced=(<img src="1405341526448.png" />)
    Speed=(<img src="1405341545558.png" />)
    AppOpen(logfile)
    <span class="cmt">#verify(logfile,redicon)
</span>    <span class="skw">click</span>(redicon)
    <span class="skw">wait</span>(<span class="dig">4</span>)
    <span class="kw">if</span> exists (GmailAcc):
        write_log(logfile,<span class="str">"Google account was already created"</span>)
        <span class="kw">return</span>
    verify(logfile,AddNew)
    <span class="skw">click</span>(AddNew)
    <span class="skw">wait</span>(<span class="dig">3</span>)
    <span class="skw">click</span>(Name)
    <span class="skw">type</span>(<span class="str">"gmail"</span>)
    <span class="skw">wait</span>(<span class="dig">3</span>)
    <span class="skw">click</span>(Address)
    <span class="skw">type</span>(<span class="str">"https://accounts.google.com"</span>)
    <span class="skw">wait</span>(<span class="dig">3</span>)
    <span class="skw">click</span>(Username)
    <span class="skw">type</span>(<span class="str">"michael.scott.avg"</span>)
    <span class="skw">wait</span>(<span class="dig">3</span>)
    <span class="skw">click</span>(Passowrd)
    <span class="skw">type</span>(<span class="str">"US!pf.avg"</span>)
    <span class="skw">wait</span>(<span class="dig">3</span>)

   <span class="cmt"># verify(logfile,Advanced)
</span>  <span class="cmt">#  click(Advanced)
</span>  <span class="cmt">#  verify(logfile,SaveChanges)
</span>    <span class="skw">click</span>(SaveChanges)
    <span class="skw">wait</span>(<span class="dig">3</span>)
    <span class="cmt">#verify(logfile,Speed)
</span>   <span class="cmt"># click(Speed)
</span>    verify(logfile,Stored)
    write_log(logfile,<span class="str">"Accout was created"</span>)


<span class="kw">def</span> delItem(log_file):
    Item=(<img src="1409316568129.png" />)
    Trash=(<img src="1405343738103-1.png" />)
    Delete=(<img src="1405587762833-1.png" />)
    <span class="skw">click</span>(redicon)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="kw">while</span> exists(Item):
        <span class="cmt">#verify(log_file,Item)
</span>        hover(Item)
        verify(log_file,Trash)
        <span class="skw">click</span>(Trash)
        verify(log_file,Delete)
        <span class="skw">click</span>(Delete)
        <span class="skw">wait</span>(<span class="dig">3</span>)

<span class="kw">def</span> LogOut(logfile):

    Logout=(<img src="1406026564033.png" />)
    Welcome=(<img src="1406026672231.png" />)

    AppOpen(logfile)
    <span class="kw">if</span> exists(Logout):
        <span class="skw">click</span>(Logout)
    verify(logfile,Welcome)




<span class="kw">if</span> __name__ == <span class="str">"__main__"</span>:
    log_file = <span class="str">""</span>
    <span class="kw">try</span>:
        script_path, test_case_script_name=os.path.split(sys.argv[<span class="dig">0</span>])
        test_case_script_name=test_case_script_name + <span class="str">".sikuli"</span>
        log_file=create_log_folder(test_case_script_name, test_case_id)

        delItem(log_file)


    <span class="kw">except</span> FindFailed, f:
        msg =  <span class="str">"Find Failed Exception: %s "</span> % f
        write_log(log_file,msg)
        FailTestCase(log_file, test_case_id)

    <span class="kw">except</span> Exception, e:
        msg =  <span class="str">"Exception detected: %s "</span> % e
        <span class="kw">print</span> <span class="str">"exception"</span>
        write_log(log_file,msg)
        FailTestCase(log_file, test_case_id)
</pre>
</body>
</html>
